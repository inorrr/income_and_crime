<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yinuo Zhao" />


<title> Midterm Project </title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">JSC370 Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Topic Description</a>
</li>
<li>
  <a href="visual.html">Interactive Visualizations</a>
</li>
<li>
  <a href="report.html">Full Report</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/inorrr/income_and_crime/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/yinuozhao/">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://jsc370.github.io/JSC370-2024/">JSC370 Home</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><center><br />
Midterm Project<br />
</center></h1>
<h4 class="author">Yinuo Zhao</h4>
<h4 class="date">Mar 2, 2024</h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><em>“Provide background on your data sets and a clear formulated
question or hypothesis.”</em></p>
<p>For this project, my question of Interest is: <strong>“How does crime
rate relate to income in Canada?”</strong></p>
<p>In order to answer this question, data on both crime and
socioeconomic status are needed. However, I found no existing data set
that contains all desired information, therefore this needs to be
achieved through merging more than one data sets. After choosing
carefully, the following two separate data sets are obtained:</p>
<ol style="list-style-type: decimal">
<li><p><strong>“Income of individuals by age group, sex and income
source, Canada, provinces and selected census metropolitan
areas”</strong>. Released 2023-05-02. This data set is annually updated
and maintained by Statistics Canada (Table 11-10-0239-01). Data is
collected through the Survey of Labor and Income Dynamics, Survey of
Consumer Finances, and Canadian Income Survey.</p></li>
<li><p><strong>“Incident-based crime statistics, by detailed violations,
Canada, provinces, territories, Census Metropolitan Areas and Canadian
Forces Military Police”</strong>. Released 2023-07-27. This data set is
also annually updated and maintained by Statistics Canada (Table
35-10-0177-01, formerly CANSIM 252-0051). Data is collected through the
Uniform Crime Reporting Survey.</p></li>
</ol>
<p>Understanding the relationship between crime rates and income in
Canada is crucial for policymakers, law enforcement agencies, and social
welfare programs. Exploring this correlation can shed light on the
socioeconomic factors driving criminal behavior and help formulate
targeted interventions to alleviate poverty and reduce crime.
Additionally, elucidating this connection can inform broader discussions
on social inequality, justice, and community well-being in Canadian
society.</p>
</div>
<div id="methods" class="section level2">
<h2>Methods</h2>
<p><em>“Include how and where the data were acquired, how you cleaned
and wrangled the data, what tools you used for data
exploration.”</em></p>
<p>Both data sets are downloaded directly from <strong>Statistics
Canada</strong>, which is usually considered to be an reliable source.
Because they share the same source, the data sets follows similar
structure and all contains the two columns <code>GEO</code> and
<code>REF_DATE</code> where the former one refers to the geographical
region and the second one refers to the year of data. Thus, it’s
possible to combine the two data sets to obtain all information
needed.</p>
<p>However, it is worth mentioning that both data sets are huge and
contains <strong>unrelated information</strong>. Therefore, cleaning and
wrangling are needed for more convenient analysis and more efficient
computing &amp; uploading, as the original data sets are oversize thus
cannot be pushed to github repository.</p>
<p>Reference:</p>
<ol style="list-style-type: decimal">
<li>The census data set: <a
href="https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1110023901"
class="uri">https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1110023901</a></li>
<li>The crime data set: <a
href="https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=3510017701"
class="uri">https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=3510017701</a></li>
</ol>
<pre class="r"><code>fn1 &lt;- &quot;https://raw.githubusercontent.com/inorrr/JSC370_project/main/census.csv&quot;
fn2 &lt;- &quot;https://raw.githubusercontent.com/inorrr/JSC370_project/main/crime.csv&quot;

if (!file.exists(&quot;data/census.csv&quot;))
  download.file(fn1, destfile = &quot;data/census.csv&quot;)
census_df &lt;- data.table::fread(&quot;data/census.csv&quot;)

if (!file.exists(&quot;data/crime.csv&quot;))
  download.file(fn2, destfile = &quot;data/crime.csv&quot;)
crime_df &lt;- data.table::fread(&quot;data/crime.csv&quot;)</code></pre>
<div id="data-wrangling-and-cleaning" class="section level3">
<h3>Data Wrangling and Cleaning</h3>
<ol style="list-style-type: decimal">
<li>First I dropped the unrelated columns in both columns, keeping only
information revelant to the question of interest.</li>
</ol>
<pre class="r"><code>crime_df &lt;- crime_df[, c(&quot;REF_DATE&quot;, &quot;GEO&quot;, &quot;Violations&quot;, &quot;Statistics&quot;, &quot;VALUE&quot;, &quot;UOM&quot;)]
census_df &lt;- census_df[, c(&quot;REF_DATE&quot;, &quot;GEO&quot;, &quot;Age group&quot;, &quot;Sex&quot;, &quot;Income source&quot;, &quot;Statistics&quot;, &quot;VALUE&quot;, &quot;UOM&quot;, &quot;SCALAR_FACTOR&quot;)]</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>I noticed that in the GEO column:</li>
</ol>
<ul>
<li>both data sets uses a <strong>mix of province &amp; city
names</strong>. I removed all observations with city names and keep only
those province data so that the data set is smaller(since the province
data contains cities already) and avoids redundancy.</li>
<li>Notice that the census data only have data from the 10 provinces,
not the <strong>3 territories</strong>, I filtered out those data from
the crime data set as there are no matching data.</li>
<li>Notice that there is a <strong>square bracket</strong> with a number
behind each province name in the crime data, therefore I removed it with
regular expression so that we can join the two data sets on province
later.</li>
</ul>
<pre class="r"><code>table(census_df$GEO)

provinces1 &lt;- c(&quot;Alberta [48]&quot;, &quot;British Columbia [59]&quot;, &quot;Manitoba [46]&quot;, &quot;New Brunswick [13]&quot;, 
               &quot;Newfoundland and Labrador [10]&quot;, &quot;Saskatchewan [47]&quot;,
               &quot;Nova Scotia [12]&quot;, &quot;Ontario [35]&quot;, 
               &quot;Prince Edward Island [11]&quot;, &quot;Quebec [24]&quot;)

provinces2 &lt;- c(&quot;Alberta&quot;, &quot;British Columbia&quot;, &quot;Manitoba&quot;, &quot;New Brunswick&quot;, 
               &quot;Newfoundland and Labrador&quot;, &quot;Saskatchewan&quot;,&quot;Nova Scotia&quot;, 
               &quot;Ontario&quot;, &quot;Prince Edward Island&quot;, &quot;Quebec&quot;)

crime_df &lt;- crime_df[crime_df$GEO %in% provinces1, ]
census_df &lt;- census_df[census_df$GEO %in% provinces2, ]

crime_df$GEO &lt;- gsub(&quot;\\s*\\[\\d+\\]$&quot;, &quot;&quot;, crime_df$GEO)
table(crime_df$GEO)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>In the Statistics column of the crime data, there are many measures
related to crime, but I’m only interested in the number of incidents
(<code>Actual incidents</code>) and crime rate
(<code>Rate per 100,000 population</code>), thus statistics related to
charges are removed. The Crime Severity
Index(<code>Percentage contribution to the Crime Severity Index (CSI)</code>)
seems to be interesting and thus is kept.</li>
</ol>
<pre class="r"><code>crime_df &lt;- crime_df %&gt;% filter(Statistics == &quot;Actual incidents&quot; | 
                                Statistics == &quot;Rate per 100,000 population&quot; | 
                                Statistics == &quot;Percentage contribution to the Crime Severity Index (CSI)&quot;)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>In the crime data frame,</li>
</ol>
<ul>
<li>there are <strong>314 different types of crime</strong>, which does
much more detailed categorization than I’m interested in. Therefore, to
avoid having too much computation to merge data later on, I choose too
keep only the bigger categories (i.e. total robbery, total assaults,
etc).</li>
<li>There are also square brackets at the end so I removed them.</li>
</ul>
<pre class="r"><code>print(length(unique(crime_df$Violations)))
table(crime_df$Violations)

# Identify rows that start with &quot;Total&quot;
total_rows &lt;- grepl(&quot;^Total&quot;, crime_df$Violations)

# Subset the dataframe to keep only the rows starting with &quot;Total&quot;
crime_df &lt;- crime_df[total_rows, , drop = FALSE]

# Remove square brackets and numbers at the end
crime_df$Violations &lt;- gsub(&quot;\\s*\\[\\d+\\]$&quot;, &quot;&quot;, crime_df$Violations)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>In the census data frame:</li>
</ol>
<ul>
<li><p>the column <code>Age group</code> specifies the age however since
we do not have this information in the crime data frame, we need to
combine all age groups. This can be done by taking the average of the
categories.</p></li>
<li><p>Same for <code>Sex</code>, same method is used.</p></li>
</ul>
<pre class="r"><code>table(census_df$&quot;Age group&quot;)
table(census_df$&quot;Sex&quot;)

# first we merge the age group categories
census_df &lt;- census_df %&gt;% 
  group_by(REF_DATE, GEO, Sex, `Income source`, Statistics, UOM, SCALAR_FACTOR) %&gt;% 
  summarise(VALUE = mean(VALUE, na.rm = TRUE))

# next we merge the age group categories
census_df &lt;- census_df_new %&gt;% 
  group_by(REF_DATE, GEO, `Income source`, Statistics, UOM, SCALAR_FACTOR) %&gt;% 
  summarise(VALUE = mean(VALUE, na.rm = TRUE))</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>I keep only the data between 1998 and 2021, as that’s the year range
where the two data sets overlap.</li>
</ol>
<pre class="r"><code>crime_df &lt;- crime_df %&gt;% filter(REF_DATE &gt;= 1998 &amp; REF_DATE &lt;= 2021)
census_df &lt;- census_df %&gt;% filter(REF_DATE &gt;= 1998 &amp; REF_DATE &lt;= 2021)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Write the cleaned data frame to CSV files.</li>
</ol>
<pre class="r"><code>write.csv(crime_df, &quot;/Users/yinuozhao/Desktop/UofT/JSC370/JSC370-2024-main/JSC370_project/crime.csv&quot;)
write.csv(census_df, &quot;/Users/yinuozhao/Desktop/UofT/JSC370/JSC370-2024-main/JSC370_project/census.csv&quot;)</code></pre>
<p>At this point both the crime data frame and census data frame has
<code>REF_DATE</code> and <code>GEO</code> in common, and they each have
another <strong>categorical variable</strong>, which is
<code>Income source</code> for census data and <code>Violation</code>(it
means crime type) for crime data. While it may seem to make sense to
join the two data sets using REF_DATE and GEO directly, the results
would involves the data for all combinations of Income source and
Violation for each REF_DATE and GEO. This will be a huge data set and
thus slow down the computation. Therefore, I choose to <strong>keep the
data sets separate</strong> and <strong>join them when
necessary</strong> (i.e. after picking out certain categories of
interest).</p>
</div>
<div id="exploratory-data-analysis" class="section level3">
<h3>Exploratory Data Analysis</h3>
<p>Notice that right now both data sets are in long format, I converted
them to wide for convenience.</p>
<pre class="r"><code>crime_df &lt;- pivot_wider(crime_df, id_cols = c(REF_DATE, GEO, Violations), 
                        names_from = Statistics, values_from = VALUE)
crime_df &lt;- na.omit(crime_df)

census_df &lt;- pivot_wider(census_df, id_cols = c(REF_DATE, GEO, `Income source`), 
                         names_from = Statistics, values_from = VALUE)
census_df &lt;- na.omit(census_df)</code></pre>
<p><em>Check the dimensions and headers and footers of the data</em></p>
<pre class="r"><code>dim(census_df)
dim(crime_df)
head(crime_df)
tail(crime_df)
head(census_df)
tail(census_df)</code></pre>
<p>The census data set has <strong>8 variables</strong> with
<strong>3613 observations</strong>, the crime data set has <strong>6
variables</strong> with <strong>9271 observations</strong>. By looking
at the headers and footers of both data sets, they seems to be imported
correctly and contains no missing values (in the displayed rows).</p>
<p><em>Check the variable types in the data</em></p>
<pre class="r"><code>str(census_df)
str(crime_df)
summary(census_df)
summary(crime_df)</code></pre>
<p>In both data frames, we see that the variable types are a mix of
integer, numeric and characters. All variable types correctly align with
the context of the variables. No major problems arises with the data at
this stage (i.e. a variable with all missing values.)</p>
<p><em>Take a closer look at some/all of the variables</em></p>
<p>For both data frame, we need <code>REF_DATE</code> and
<code>GEO</code> to correctly identify a province in Canada with a valid
year. For census data frame, we need to look at the values of the
different types of income (median, aggregate, etc). For the crime data
frame, we need to look at the recorded crime rate and actual number of
incidents to be within the reasonable range.</p>
<pre class="r"><code>table(census_df$REF_DATE)
table(census_df$GEO)
table(crime_df$REF_DATE)
table(crime_df$GEO)
summary(census_df$`Aggregate income`)
summary(census_df$`Average income (excluding zeros)`)
summary(census_df$`Median income (excluding zeros)`)
summary(crime_df$`Actual incidents`)
summary(crime_df$`Rate per 100,000 population`)</code></pre>
<p>Both data sets contains data from 1998 to 2021, on the 10 provinces
in Canada as desired because I cleaned the data sets this way. Other
variables being checked are within the reasonable range. The aggregate
income, average income and median income are all measured in 2021
constant dollars, aggregate income record numbers in millions. The crime
rates are measured as number of incidents per 100,000 population.</p>
<p><em>Validate with an external source</em></p>
<p>Notice that the minimum average income is <strong>677.8</strong>,
which seems to be much lower than then mean average income, even 10
times lower than the 1st quantile. Since it seems quite suspicious, we
need to validate it.</p>
<pre class="r"><code>census_df[which.min(census_df$`Average income (excluding zeros)`), ]</code></pre>
<p>This data is from <strong>Prince Edward Island</strong> in 2004, and
the income source is <strong>“other government transfers”</strong>. Upon
research, Government transfers refers to assistance from provincial and
municipal programs, Workers’ Compensation benefits, the GST/HST Credit
and provincial refundable tax credits such as the Quebec and
Newfoundland and Labrador sales tax credits. However, since many of the
above mentioned are made to their own category and excluded from “other
government transfers” in the data set, it make sense that the value is
low.</p>
</div>
</div>
<div id="preliminary-results" class="section level2">
<h2>Preliminary Results</h2>
<p><em>“Provide summary statistics in tabular from and
publication-quality figures, take a look at the kable function from
knitr to write nice tables in Rmarkdown.”</em></p>
<div id="looking-at-crime-data" class="section level3">
<h3>Looking at Crime Data</h3>
<p>Firstly, I examined the trend in crime rate across provinces and
crime types.</p>
<pre class="r"><code>filtered_data = crime_df %&gt;% filter(Violations==&quot;Total, all violations&quot;)
unique_x_values &lt;- unique(crime_df$REF_DATE)
ggplot(filtered_data, aes(x = REF_DATE, y = `Rate per 100,000 population`, color = GEO)) +
  geom_line() +
  labs(x = &quot;Year&quot;, y = &quot;Rate per 100,000 population&quot;, title = &quot;Rates of Total Crime by Province&quot;) +
  scale_x_continuous(breaks = unique_x_values) + 
  scale_color_discrete(name = &quot;Provinces&quot;) + 
  theme_linedraw() +
  theme(legend.position = &quot;right&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  theme(plot.title = element_text(face = &quot;bold&quot;)) + 
  theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), &quot;cm&quot;)) + 
  theme(axis.text = element_text(size = 7)) + 
  theme(legend.title = element_text(face = &quot;bold&quot;))</code></pre>
<p><img src="work_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;" />
The plot depicts the <strong>total crime rate</strong>, encompassing all
types of crimes, from 1998 to 2021, with each province represented by a
distinct color. The crime rate is measured per 100,000 population.
Notably, Saskatchewan consistently exhibits a significantly higher crime
rate compared to other provinces throughout the period of 1998 to 2021.
Conversely, Quebec and Ontario consistently demonstrate the lowest crime
rates. Across all provinces, there is a discernible <strong>decreasing
trend</strong> in crime rates over the years, with many provinces
experiencing peak crime rates in 2003-2004.</p>
<p>In addition to analyzing total crime, I delved into specific crime
categories often associated with poverty: <strong>break and
enter</strong>, <strong>robbery</strong>, and
<strong>prostitution</strong>. The three accompanying plots illustrate
their respective rates over the years. Overall, there is a decreasing
trend in the rates of all three crimes, with occasional exceptions such
as robbery rates in Manitoba. Notably, British Columbia stands out with
a significantly high rate of prostitution in 2004, doubling the number
reported in Saskatchewan, which held the second-highest rate that
year.</p>
<p><em>Note that the 3 plots below shares the same legend with the above
plots. Therefore the legend is omitted for better display purpose. Codes
are also not shown as they reuses the above code chunk. Crime rate is
measured per 100,000 population.</em></p>
<p><img src="work_files/figure-html/unnamed-chunk-15-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>Presented below is a table summarizing the average crime rate across
all crime types (excluding <code>Total, all violations</code>)
categorized by province and year. The cells are color-coded by value,
with lighter shades indicating higher values and darker shades
representing smaller values. Upon scrolling through the table, it
becomes evident that across all provinces, there is a discernible
<strong>decreasing trend in the average crime rate</strong>, as
evidenced by the darkening shades in each column. This observation
aligns with the findings and inferences drawn from the preceding
plots.</p>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table" style="margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;" colspan="11">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Table of Average Crime Rate Across All Types
</div>
</th>
</tr>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Alberta
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
British Columbia
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Manitoba
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
New Brunswick
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Newfoundland and Labrador
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Nova Scotia
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Ontario
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Prince Edward Island
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Quebec
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Saskatchewan
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1998
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 192, 111, 255) !important;">
990.7389
</td>
<td style="text-align:right;color: white !important;background-color: rgba(246, 230, 32, 255) !important;">
1310.2795
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 161, 135, 255) !important;">
1140.4897
</td>
<td style="text-align:right;color: white !important;background-color: rgba(178, 221, 45, 255) !important;">
746.1692
</td>
<td style="text-align:right;color: white !important;background-color: rgba(42, 176, 127, 255) !important;">
644.1653
</td>
<td style="text-align:right;color: white !important;background-color: rgba(192, 223, 37, 255) !important;">
875.0903
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
776.1408
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 153, 138, 255) !important;">
686.4670
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
702.7424
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 149, 139, 255) !important;">
1420.691
</td>
</tr>
<tr>
<td style="text-align:right;">
1999
</td>
<td style="text-align:right;color: white !important;background-color: rgba(80, 196, 106, 255) !important;">
996.9833
</td>
<td style="text-align:right;color: white !important;background-color: rgba(173, 220, 48, 255) !important;">
1243.8727
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 161, 136, 255) !important;">
1139.4081
</td>
<td style="text-align:right;color: white !important;background-color: rgba(192, 223, 37, 255) !important;">
751.8170
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 146, 140, 255) !important;">
616.3186
</td>
<td style="text-align:right;color: white !important;background-color: rgba(216, 226, 25, 255) !important;">
890.2262
</td>
<td style="text-align:right;color: white !important;background-color: rgba(142, 214, 69, 255) !important;">
705.8405
</td>
<td style="text-align:right;color: white !important;background-color: rgba(88, 199, 101, 255) !important;">
786.3608
</td>
<td style="text-align:right;color: white !important;background-color: rgba(165, 219, 54, 255) !important;">
649.5519
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
1372.294
</td>
</tr>
<tr>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 160, 136, 255) !important;">
938.1432
</td>
<td style="text-align:right;color: white !important;background-color: rgba(129, 211, 77, 255) !important;">
1202.5849
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 163, 134, 255) !important;">
1146.4238
</td>
<td style="text-align:right;color: white !important;background-color: rgba(119, 209, 83, 255) !important;">
719.6546
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 152, 139, 255) !important;">
621.9546
</td>
<td style="text-align:right;color: white !important;background-color: rgba(92, 200, 99, 255) !important;">
807.6322
</td>
<td style="text-align:right;color: white !important;background-color: rgba(127, 211, 78, 255) !important;">
695.1511
</td>
<td style="text-align:right;color: white !important;background-color: rgba(45, 178, 125, 255) !important;">
739.1711
</td>
<td style="text-align:right;color: white !important;background-color: rgba(173, 220, 48, 255) !important;">
653.3770
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 152, 139, 255) !important;">
1428.722
</td>
</tr>
<tr>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;color: white !important;background-color: rgba(58, 186, 118, 255) !important;">
979.9516
</td>
<td style="text-align:right;color: white !important;background-color: rgba(162, 218, 55, 255) !important;">
1233.4349
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 193, 110, 255) !important;">
1213.3189
</td>
<td style="text-align:right;color: white !important;background-color: rgba(105, 205, 91, 255) !important;">
712.1708
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 147, 140, 255) !important;">
617.2849
</td>
<td style="text-align:right;color: white !important;background-color: rgba(99, 203, 95, 255) !important;">
812.8562
</td>
<td style="text-align:right;color: white !important;background-color: rgba(94, 201, 98, 255) !important;">
672.0454
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 184, 120, 255) !important;">
752.6111
</td>
<td style="text-align:right;color: white !important;background-color: rgba(142, 214, 69, 255) !important;">
634.2719
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 185, 119, 255) !important;">
1518.370
</td>
</tr>
<tr>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;color: white !important;background-color: rgba(76, 194, 108, 255) !important;">
994.3392
</td>
<td style="text-align:right;color: white !important;background-color: rgba(176, 221, 47, 255) !important;">
1245.2322
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 188, 115, 255) !important;">
1202.5438
</td>
<td style="text-align:right;color: white !important;background-color: rgba(134, 213, 73, 255) !important;">
726.1322
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 171, 130, 255) !important;">
639.0897
</td>
<td style="text-align:right;color: white !important;background-color: rgba(103, 204, 92, 255) !important;">
816.2289
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 191, 112, 255) !important;">
651.8003
</td>
<td style="text-align:right;color: white !important;background-color: rgba(168, 219, 52, 255) !important;">
850.6072
</td>
<td style="text-align:right;color: white !important;background-color: rgba(115, 208, 86, 255) !important;">
617.0995
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 181, 123, 255) !important;">
1505.492
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;color: white !important;background-color: rgba(194, 223, 35, 255) !important;">
1065.0392
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
1317.9670
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
1366.9247
</td>
<td style="text-align:right;color: white !important;background-color: rgba(205, 225, 29, 255) !important;">
758.0414
</td>
<td style="text-align:right;color: white !important;background-color: rgba(64, 189, 114, 255) !important;">
657.4530
</td>
<td style="text-align:right;color: white !important;background-color: rgba(221, 227, 24, 255) !important;">
893.6070
</td>
<td style="text-align:right;color: white !important;background-color: rgba(50, 182, 122, 255) !important;">
632.2778
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
915.8641
</td>
<td style="text-align:right;color: white !important;background-color: rgba(147, 215, 65, 255) !important;">
638.6003
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
1728.543
</td>
</tr>
<tr>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
1098.5319
</td>
<td style="text-align:right;color: white !important;background-color: rgba(251, 231, 35, 255) !important;">
1315.9251
</td>
<td style="text-align:right;color: white !important;background-color: rgba(231, 228, 25, 255) !important;">
1347.9319
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
780.0538
</td>
<td style="text-align:right;color: white !important;background-color: rgba(86, 198, 103, 255) !important;">
667.5708
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
915.0119
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 161, 136, 255) !important;">
595.3678
</td>
<td style="text-align:right;color: white !important;background-color: rgba(223, 227, 24, 255) !important;">
893.0314
</td>
<td style="text-align:right;color: white !important;background-color: rgba(124, 210, 80, 255) !important;">
624.6361
</td>
<td style="text-align:right;color: white !important;background-color: rgba(208, 225, 28, 255) !important;">
1684.091
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;color: white !important;background-color: rgba(221, 227, 24, 255) !important;">
1079.1975
</td>
<td style="text-align:right;color: white !important;background-color: rgba(192, 223, 37, 255) !important;">
1260.0459
</td>
<td style="text-align:right;color: white !important;background-color: rgba(142, 214, 69, 255) !important;">
1278.7128
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 192, 111, 255) !important;">
692.0257
</td>
<td style="text-align:right;color: white !important;background-color: rgba(52, 182, 121, 255) !important;">
650.8968
</td>
<td style="text-align:right;color: white !important;background-color: rgba(168, 219, 52, 255) !important;">
859.9862
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 148, 140, 255) !important;">
574.3292
</td>
<td style="text-align:right;color: white !important;background-color: rgba(117, 208, 84, 255) !important;">
812.8373
</td>
<td style="text-align:right;color: white !important;background-color: rgba(112, 207, 87, 255) !important;">
615.6142
</td>
<td style="text-align:right;color: white !important;background-color: rgba(173, 220, 48, 255) !important;">
1649.431
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;color: white !important;background-color: rgba(94, 201, 98, 255) !important;">
1007.2778
</td>
<td style="text-align:right;color: white !important;background-color: rgba(129, 211, 77, 255) !important;">
1203.3584
</td>
<td style="text-align:right;color: white !important;background-color: rgba(119, 209, 83, 255) !important;">
1260.0861
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
648.6084
</td>
<td style="text-align:right;color: white !important;background-color: rgba(86, 198, 103, 255) !important;">
667.1994
</td>
<td style="text-align:right;color: white !important;background-color: rgba(162, 218, 55, 255) !important;">
856.8851
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
589.4051
</td>
<td style="text-align:right;color: white !important;background-color: rgba(45, 178, 125, 255) !important;">
737.7965
</td>
<td style="text-align:right;color: white !important;background-color: rgba(103, 204, 92, 255) !important;">
609.9108
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 179, 124, 255) !important;">
1502.769
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;color: white !important;background-color: rgba(112, 207, 87, 255) !important;">
1018.9281
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 192, 111, 255) !important;">
1137.0500
</td>
<td style="text-align:right;color: white !important;background-color: rgba(84, 197, 104, 255) !important;">
1226.7060
</td>
<td style="text-align:right;color: white !important;background-color: rgba(39, 126, 142, 255) !important;">
608.8173
</td>
<td style="text-align:right;color: white !important;background-color: rgba(170, 220, 50, 255) !important;">
697.5675
</td>
<td style="text-align:right;color: white !important;background-color: rgba(86, 198, 103, 255) !important;">
803.5808
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 141, 141, 255) !important;">
560.8689
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 146, 140, 255) !important;">
670.0778
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 192, 111, 255) !important;">
584.9914
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 172, 130, 255) !important;">
1480.692
</td>
</tr>
<tr>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 188, 115, 255) !important;">
984.9581
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
1046.3411
</td>
<td style="text-align:right;color: white !important;background-color: rgba(36, 134, 142, 255) !important;">
1081.2483
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 139, 141, 255) !important;">
624.8186
</td>
<td style="text-align:right;color: white !important;background-color: rgba(168, 219, 52, 255) !important;">
696.9058
</td>
<td style="text-align:right;color: white !important;background-color: rgba(53, 183, 121, 255) !important;">
772.9158
</td>
<td style="text-align:right;color: white !important;background-color: rgba(39, 128, 142, 255) !important;">
537.7905
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 152, 139, 255) !important;">
683.8757
</td>
<td style="text-align:right;color: white !important;background-color: rgba(76, 194, 108, 255) !important;">
589.6462
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 146, 140, 255) !important;">
1412.581
</td>
</tr>
<tr>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
935.6630
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 133, 142, 255) !important;">
983.8919
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 167, 133, 255) !important;">
1153.1356
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
615.0719
</td>
<td style="text-align:right;color: white !important;background-color: rgba(229, 228, 25, 255) !important;">
716.9997
</td>
<td style="text-align:right;color: white !important;background-color: rgba(53, 183, 121, 255) !important;">
773.6461
</td>
<td style="text-align:right;color: white !important;background-color: rgba(42, 119, 142, 255) !important;">
521.8932
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 159, 136, 255) !important;">
697.9243
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 188, 115, 255) !important;">
578.2262
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 143, 141, 255) !important;">
1403.483
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;color: white !important;background-color: rgba(40, 125, 142, 255) !important;">
884.1551
</td>
<td style="text-align:right;color: white !important;background-color: rgba(44, 113, 142, 255) !important;">
933.4835
</td>
<td style="text-align:right;color: white !important;background-color: rgba(43, 116, 142, 255) !important;">
1043.1349
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 139, 141, 255) !important;">
625.0964
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
725.7876
</td>
<td style="text-align:right;color: white !important;background-color: rgba(45, 178, 125, 255) !important;">
763.8995
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 104, 142, 255) !important;">
496.5708
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 160, 136, 255) !important;">
699.9311
</td>
<td style="text-align:right;color: white !important;background-color: rgba(47, 180, 124, 255) !important;">
562.8811
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 153, 138, 255) !important;">
1432.178
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 74, 137, 255) !important;">
812.9859
</td>
<td style="text-align:right;color: white !important;background-color: rgba(54, 92, 141, 255) !important;">
880.2127
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 102, 142, 255) !important;">
1012.0920
</td>
<td style="text-align:right;color: white !important;background-color: rgba(50, 101, 142, 255) !important;">
577.9611
</td>
<td style="text-align:right;color: white !important;background-color: rgba(194, 223, 35, 255) !important;">
705.3294
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 150, 139, 255) !important;">
714.0051
</td>
<td style="text-align:right;color: white !important;background-color: rgba(57, 86, 140, 255) !important;">
468.0995
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 165, 133, 255) !important;">
710.5243
</td>
<td style="text-align:right;color: white !important;background-color: rgba(30, 155, 138, 255) !important;">
519.5841
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 145, 140, 255) !important;">
1408.674
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;color: white !important;background-color: rgba(60, 80, 139, 255) !important;">
819.5778
</td>
<td style="text-align:right;color: white !important;background-color: rgba(59, 81, 139, 255) !important;">
856.2392
</td>
<td style="text-align:right;color: white !important;background-color: rgba(52, 97, 141, 255) !important;">
1000.7560
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
615.4689
</td>
<td style="text-align:right;color: white !important;background-color: rgba(168, 219, 52, 255) !important;">
696.8877
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 151, 139, 255) !important;">
714.1444
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 74, 137, 255) !important;">
449.8354
</td>
<td style="text-align:right;color: white !important;background-color: rgba(36, 170, 131, 255) !important;">
721.6681
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 149, 139, 255) !important;">
510.7627
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 109, 142, 255) !important;">
1311.701
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 47, 125, 255) !important;">
778.9997
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 56, 130, 255) !important;">
803.0581
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 20, 103, 255) !important;">
866.5694
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 64, 134, 255) !important;">
538.5750
</td>
<td style="text-align:right;color: white !important;background-color: rgba(124, 210, 80, 255) !important;">
682.2809
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 109, 142, 255) !important;">
639.5953
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 45, 123, 255) !important;">
408.5759
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 146, 140, 255) !important;">
669.5086
</td>
<td style="text-align:right;color: white !important;background-color: rgba(42, 119, 142, 255) !important;">
460.8854
</td>
<td style="text-align:right;color: white !important;background-color: rgba(64, 70, 136, 255) !important;">
1218.580
</td>
</tr>
<tr>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 51, 127, 255) !important;">
783.3216
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 51, 127, 255) !important;">
792.6345
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
840.0633
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
482.3608
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 168, 132, 255) !important;">
636.2366
</td>
<td style="text-align:right;color: white !important;background-color: rgba(61, 77, 138, 255) !important;">
587.6563
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 31, 112, 255) !important;">
391.6511
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 63, 133, 255) !important;">
510.4745
</td>
<td style="text-align:right;color: white !important;background-color: rgba(52, 96, 141, 255) !important;">
421.5565
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 40, 120, 255) !important;">
1155.519
</td>
</tr>
<tr>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;color: white !important;background-color: rgba(48, 106, 142, 255) !important;">
855.7324
</td>
<td style="text-align:right;color: white !important;background-color: rgba(65, 68, 135, 255) !important;">
827.4308
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 38, 119, 255) !important;">
894.7058
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 53, 129, 255) !important;">
527.3759
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 167, 133, 255) !important;">
635.6389
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 51, 127, 255) !important;">
551.9057
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 32, 113, 255) !important;">
391.9432
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 24, 106, 255) !important;">
451.0126
</td>
<td style="text-align:right;color: white !important;background-color: rgba(59, 81, 139, 255) !important;">
399.5150
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 88, 140, 255) !important;">
1258.409
</td>
</tr>
<tr>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;color: white !important;background-color: rgba(44, 115, 142, 255) !important;">
869.6887
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 63, 133, 255) !important;">
818.0165
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 74, 137, 255) !important;">
956.7842
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 29, 111, 255) !important;">
505.9946
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 161, 135, 255) !important;">
630.6538
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 41, 121, 255) !important;">
538.1619
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 37, 118, 255) !important;">
399.0192
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 36, 117, 255) !important;">
468.5732
</td>
<td style="text-align:right;color: white !important;background-color: rgba(58, 84, 140, 255) !important;">
405.6246
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 111, 142, 255) !important;">
1317.321
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 153, 138, 255) !important;">
927.8811
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 45, 123, 255) !important;">
781.4886
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 73, 137, 255) !important;">
955.9997
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 74, 137, 255) !important;">
549.3957
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 111, 142, 255) !important;">
583.0170
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 50, 126, 255) !important;">
549.4824
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 51, 127, 255) !important;">
417.5035
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 17, 100, 255) !important;">
439.5063
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 89, 140, 255) !important;">
410.9189
</td>
<td style="text-align:right;color: white !important;background-color: rgba(54, 93, 141, 255) !important;">
1271.176
</td>
</tr>
<tr>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;color: white !important;background-color: rgba(39, 126, 142, 255) !important;">
886.8923
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 10, 93, 255) !important;">
718.8339
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 48, 126, 255) !important;">
912.0272
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 20, 103, 255) !important;">
497.1263
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
502.9756
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 4, 87, 255) !important;">
493.3066
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 38, 119, 255) !important;">
400.3605
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 23, 105, 255) !important;">
447.9967
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 35, 116, 255) !important;">
339.5035
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 56, 130, 255) !important;">
1188.911
</td>
</tr>
<tr>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 151, 139, 255) !important;">
925.4612
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 53, 129, 255) !important;">
796.9984
</td>
<td style="text-align:right;color: white !important;background-color: rgba(48, 105, 142, 255) !important;">
1016.7941
</td>
<td style="text-align:right;color: white !important;background-color: rgba(64, 70, 136, 255) !important;">
544.1014
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 76, 138, 255) !important;">
553.7074
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 8, 92, 255) !important;">
498.5129
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 41, 121, 255) !important;">
404.5249
</td>
<td style="text-align:right;color: white !important;background-color: rgba(65, 68, 135, 255) !important;">
518.0077
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 24, 106, 255) !important;">
326.3725
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 37, 118, 255) !important;">
1151.130
</td>
</tr>
<tr>
<td style="text-align:right;">
2020
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 55, 129, 255) !important;">
788.6307
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 20, 103, 255) !important;">
735.6162
</td>
<td style="text-align:right;color: white !important;background-color: rgba(65, 66, 135, 255) !important;">
943.0979
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 90, 140, 255) !important;">
564.7014
</td>
<td style="text-align:right;color: white !important;background-color: rgba(59, 81, 139, 255) !important;">
557.8670
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 2, 86, 255) !important;">
491.2514
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
356.3917
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 22, 104, 255) !important;">
446.2160
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
301.0057
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
1085.383
</td>
</tr>
<tr>
<td style="text-align:right;">
2021
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
730.3198
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
703.6836
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
839.5900
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 111, 142, 255) !important;">
590.1656
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
602.4644
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
489.7486
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 5, 89, 255) !important;">
360.7433
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
418.9484
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 11, 94, 255) !important;">
312.5548
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 13, 96, 255) !important;">
1106.370
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="looking-at-income-data" class="section level3">
<h3>Looking at Income Data</h3>
<p>Given the general decrease in crime rates, I am interested in
exploring the <strong>trend of income</strong> to ascertain the
potential existence of an association.</p>
<p>The following plot illustrates the average total income of each
province over time. It is evident that, on the whole, the average total
income for all provinces exhibits a steady <strong>upward
trend</strong>. Notably, since 2003, Alberta has surpassed Ontario to
become the province with the highest average total income. Additionally,
it is noteworthy to observe a slight decrease in income across all
provinces around 2019, likely attributed to the impact of the COVID-19
pandemic.</p>
<p><img src="work_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>The box plot below also shows the average total income for different
years, but this time combining data from all provinces. The pink dots
represent the actual values for each year in each province. It’s clear
from the boxes that the average income is <strong>increasing</strong>
year by year. Notably, between 2010 and 2016, there are some outliers
with very high incomes, which corresponds to Alberta when compared with
the previous plot. However, it is worth mentioning that the values for
income is not properly adjusted for inflation, therefore the actual
growth is not as strong as we see in the current data.</p>
<p><img src="work_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>After examining total income, I delved into specific income sources:
employment income, investment income, and market income, which are major
income categories. The plots below illustrate that all three types of
income are increasing. However, employment and market income show a more
steady growth pattern, while investment income fluctuates dramatically
from year to year. <em>(Same as before, the same legend is omitted for
display purpose since I’m only interested in the overall trend, not how
provinces compare to each other.)</em></p>
<p><img src="work_files/figure-html/unnamed-chunk-19-1.png" width="1440" style="display: block; margin: auto;" />
The table below provides a summary of the average total income of all
provinces from 1998 to 2021. The color scale used is consistent with
that of the crime data frame, where lighter shades denote higher values.
Over time, there is a discernible increase in income, as evidenced by
the progressive lightening of colors.</p>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table" style="margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;" colspan="11">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Table of Average Total Income
</div>
</th>
</tr>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Year
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Alberta
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
British Columbia
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Manitoba
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
New Brunswick
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Newfoundland and Labrador
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Nova Scotia
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Ontario
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Prince Edward Island
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Quebec
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Saskatchewan
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1998
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 11, 94, 255) !important;">
44804.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
40441.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 5, 89, 255) !important;">
38208.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
34125.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
30316.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
34320.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
45100.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
32633.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
37412.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
37370.83
</td>
</tr>
<tr>
<td style="text-align:right;">
1999
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
44237.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 24, 106, 255) !important;">
41416.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 1, 84, 255) !important;">
38075.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 27, 109, 255) !important;">
35112.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 27, 109, 255) !important;">
31783.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 48, 126, 255) !important;">
36316.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 47, 125, 255) !important;">
46620.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 11, 94, 255) !important;">
33058.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 28, 110, 255) !important;">
38520.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 14, 97, 255) !important;">
38000.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 29, 111, 255) !important;">
45795.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 26, 108, 255) !important;">
41462.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 23, 105, 255) !important;">
38841.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 38, 119, 255) !important;">
35654.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 38, 119, 255) !important;">
32533.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 64, 134, 255) !important;">
37070.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 88, 140, 255) !important;">
48170.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 38, 119, 255) !important;">
34225.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 55, 129, 255) !important;">
39716.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 26, 108, 255) !important;">
38579.17
</td>
</tr>
<tr>
<td style="text-align:right;">
2001
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 63, 133, 255) !important;">
47845.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 36, 117, 255) !important;">
41916.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 45, 123, 255) !important;">
39650.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 58, 131, 255) !important;">
36537.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 40, 120, 255) !important;">
32600.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(59, 81, 139, 255) !important;">
37950.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 90, 140, 255) !important;">
48279.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 44, 122, 255) !important;">
34445.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 71, 136, 255) !important;">
40520.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 55, 129, 255) !important;">
40308.33
</td>
</tr>
<tr>
<td style="text-align:right;">
2002
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 48, 126, 255) !important;">
46983.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 52, 128, 255) !important;">
42695.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 44, 122, 255) !important;">
39629.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 44, 122, 255) !important;">
35870.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 50, 126, 255) !important;">
33270.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 91, 141, 255) !important;">
38487.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(57, 85, 140, 255) !important;">
48091.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 55, 129, 255) !important;">
35020.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 76, 138, 255) !important;">
40791.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 52, 128, 255) !important;">
40150.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2003
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 63, 133, 255) !important;">
47920.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 32, 113, 255) !important;">
41787.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 56, 130, 255) !important;">
40129.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 50, 126, 255) !important;">
36108.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(71, 47, 125, 255) !important;">
33125.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(61, 77, 138, 255) !important;">
37716.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(60, 79, 138, 255) !important;">
47812.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(67, 61, 132, 255) !important;">
35325.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 71, 136, 255) !important;">
40570.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 59, 132, 255) !important;">
40554.17
</td>
</tr>
<tr>
<td style="text-align:right;">
2004
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 89, 140, 255) !important;">
49666.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(68, 57, 131, 255) !important;">
42941.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(61, 77, 138, 255) !important;">
41029.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 56, 130, 255) !important;">
36433.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 52, 128, 255) !important;">
33470.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(57, 85, 140, 255) !important;">
38187.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 88, 140, 255) !important;">
48170.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 76, 138, 255) !important;">
36070.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 91, 141, 255) !important;">
41600.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 56, 130, 255) !important;">
40345.83
</td>
</tr>
<tr>
<td style="text-align:right;">
2005
</td>
<td style="text-align:right;color: white !important;background-color: rgba(44, 115, 142, 255) !important;">
51758.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 73, 137, 255) !important;">
43800.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(54, 92, 141, 255) !important;">
41700.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(69, 56, 130, 255) !important;">
36400.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(62, 74, 137, 255) !important;">
35012.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(48, 105, 142, 255) !important;">
39283.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(54, 93, 141, 255) !important;">
48395.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(56, 89, 140, 255) !important;">
36800.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(61, 77, 138, 255) !important;">
40804.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(58, 84, 140, 255) !important;">
42166.67
</td>
</tr>
<tr>
<td style="text-align:right;">
2006
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 141, 141, 255) !important;">
53820.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 90, 140, 255) !important;">
44679.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 109, 142, 255) !important;">
42562.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(61, 78, 138, 255) !important;">
37479.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(51, 98, 141, 255) !important;">
36858.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(41, 123, 142, 255) !important;">
40408.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 65, 134, 255) !important;">
47258.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 110, 142, 255) !important;">
38000.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(55, 91, 141, 255) !important;">
41604.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(41, 121, 142, 255) !important;">
44904.17
</td>
</tr>
<tr>
<td style="text-align:right;">
2007
</td>
<td style="text-align:right;color: white !important;background-color: rgba(44, 177, 126, 255) !important;">
56879.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 109, 142, 255) !important;">
45850.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 148, 140, 255) !important;">
44633.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 110, 142, 255) !important;">
39200.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(39, 127, 142, 255) !important;">
39304.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(35, 138, 141, 255) !important;">
41320.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(57, 85, 140, 255) !important;">
48079.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(45, 112, 142, 255) !important;">
38120.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(48, 106, 142, 255) !important;">
42441.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
47750.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;color: white !important;background-color: rgba(52, 182, 121, 255) !important;">
57337.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(40, 125, 142, 255) !important;">
46858.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 172, 130, 255) !important;">
45875.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(44, 115, 142, 255) !important;">
39520.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 140, 141, 255) !important;">
40412.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
40933.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 111, 142, 255) !important;">
49212.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 133, 142, 255) !important;">
39500.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(52, 97, 141, 255) !important;">
41925.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(41, 175, 127, 255) !important;">
49100.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2009
</td>
<td style="text-align:right;color: white !important;background-color: rgba(50, 182, 122, 255) !important;">
57237.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 110, 142, 255) !important;">
45875.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 163, 134, 255) !important;">
45437.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
40466.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 141, 141, 255) !important;">
40500.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(30, 155, 138, 255) !important;">
42362.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(54, 93, 141, 255) !important;">
48404.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(36, 134, 142, 255) !important;">
39587.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(47, 108, 142, 255) !important;">
42545.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(74, 193, 109, 255) !important;">
50650.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2010
</td>
<td style="text-align:right;color: white !important;background-color: rgba(58, 186, 118, 255) !important;">
57650.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 102, 142, 255) !important;">
45400.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
45129.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 131, 142, 255) !important;">
40470.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 160, 136, 255) !important;">
42195.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 143, 141, 255) !important;">
41579.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 104, 142, 255) !important;">
48891.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 139, 141, 255) !important;">
39841.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(46, 110, 142, 255) !important;">
42662.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(66, 190, 113, 255) !important;">
50337.50
</td>
</tr>
<tr>
<td style="text-align:right;">
2011
</td>
<td style="text-align:right;color: white !important;background-color: rgba(94, 201, 98, 255) !important;">
59145.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(48, 106, 142, 255) !important;">
45633.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 149, 139, 255) !important;">
44687.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 148, 140, 255) !important;">
41508.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 181, 123, 255) !important;">
44045.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 158, 137, 255) !important;">
42516.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(57, 86, 140, 255) !important;">
48133.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 162, 135, 255) !important;">
41354.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(38, 129, 142, 255) !important;">
43833.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(129, 211, 77, 255) !important;">
52483.33
</td>
</tr>
<tr>
<td style="text-align:right;">
2012
</td>
<td style="text-align:right;color: white !important;background-color: rgba(192, 223, 37, 255) !important;">
62166.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(43, 117, 142, 255) !important;">
46400.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 159, 136, 255) !important;">
45195.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 147, 140, 255) !important;">
41458.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(94, 201, 98, 255) !important;">
46112.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 171, 130, 255) !important;">
43358.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(51, 99, 141, 255) !important;">
48645.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 150, 139, 255) !important;">
40562.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(35, 136, 142, 255) !important;">
44308.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(137, 213, 72, 255) !important;">
52687.50
</td>
</tr>
<tr>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;color: white !important;background-color: rgba(184, 222, 41, 255) !important;">
61962.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(34, 141, 141, 255) !important;">
47854.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 188, 115, 255) !important;">
46837.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 159, 136, 255) !important;">
42095.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(168, 219, 52, 255) !important;">
48583.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(88, 199, 101, 255) !important;">
45220.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(42, 119, 142, 255) !important;">
49600.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 181, 123, 255) !important;">
42529.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 143, 141, 255) !important;">
44716.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(170, 220, 50, 255) !important;">
53658.33
</td>
</tr>
<tr>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;color: white !important;background-color: rgba(226, 228, 24, 255) !important;">
63200.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 142, 141, 255) !important;">
47929.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(74, 193, 109, 255) !important;">
47129.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(33, 166, 133, 255) !important;">
42545.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(202, 225, 31, 255) !important;">
49654.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(96, 202, 96, 255) !important;">
45504.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(38, 130, 142, 255) !important;">
50062.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(52, 182, 121, 255) !important;">
42658.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 148, 140, 255) !important;">
45041.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
55975.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2015
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
64020.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(36, 134, 142, 255) !important;">
47437.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(115, 208, 86, 255) !important;">
48054.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 159, 136, 255) !important;">
42104.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(216, 226, 25, 255) !important;">
50033.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(94, 201, 98, 255) !important;">
45445.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 151, 139, 255) !important;">
51083.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(70, 192, 111, 255) !important;">
43308.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(35, 137, 142, 255) !important;">
44354.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(216, 226, 25, 255) !important;">
54908.33
</td>
</tr>
<tr>
<td style="text-align:right;">
2016
</td>
<td style="text-align:right;color: white !important;background-color: rgba(58, 186, 118, 255) !important;">
57637.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(37, 132, 142, 255) !important;">
47354.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(86, 198, 103, 255) !important;">
47425.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(47, 180, 124, 255) !important;">
43383.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(162, 218, 55, 255) !important;">
48466.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(112, 207, 87, 255) !important;">
45908.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(31, 153, 138, 255) !important;">
51191.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(72, 193, 110, 255) !important;">
43366.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(32, 163, 134, 255) !important;">
45983.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(142, 214, 69, 255) !important;">
52816.67
</td>
</tr>
<tr>
<td style="text-align:right;">
2017
</td>
<td style="text-align:right;color: white !important;background-color: rgba(115, 208, 86, 255) !important;">
59825.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(53, 183, 121, 255) !important;">
50650.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(189, 223, 38, 255) !important;">
49529.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(94, 201, 98, 255) !important;">
44858.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(170, 220, 50, 255) !important;">
48633.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(101, 203, 94, 255) !important;">
45612.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(53, 183, 121, 255) !important;">
52683.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(103, 204, 92, 255) !important;">
44245.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(36, 170, 131, 255) !important;">
46412.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(181, 222, 43, 255) !important;">
53900.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2018
</td>
<td style="text-align:right;color: white !important;background-color: rgba(103, 204, 92, 255) !important;">
59458.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(63, 188, 115, 255) !important;">
51012.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(155, 217, 60, 255) !important;">
48875.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(149, 216, 64, 255) !important;">
46133.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(186, 222, 40, 255) !important;">
49154.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(139, 214, 70, 255) !important;">
46508.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(53, 183, 121, 255) !important;">
52650.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(132, 212, 75, 255) !important;">
44962.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(49, 181, 123, 255) !important;">
47091.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(127, 211, 78, 255) !important;">
52412.50
</td>
</tr>
<tr>
<td style="text-align:right;">
2019
</td>
<td style="text-align:right;color: white !important;background-color: rgba(86, 198, 103, 255) !important;">
58787.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(88, 199, 101, 255) !important;">
51791.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(112, 207, 87, 255) !important;">
48016.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(134, 213, 73, 255) !important;">
45779.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(170, 220, 50, 255) !important;">
48695.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(137, 213, 72, 255) !important;">
46437.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(39, 173, 129, 255) !important;">
52162.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(117, 208, 84, 255) !important;">
44616.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(105, 205, 91, 255) !important;">
48854.17
</td>
<td style="text-align:right;color: white !important;background-color: rgba(92, 200, 99, 255) !important;">
51304.17
</td>
</tr>
<tr>
<td style="text-align:right;">
2020
</td>
<td style="text-align:right;color: white !important;background-color: rgba(64, 189, 114, 255) !important;">
57991.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(202, 225, 31, 255) !important;">
54508.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
50758.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(251, 231, 35, 255) !important;">
48325.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(218, 227, 25, 255) !important;">
50183.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(231, 228, 25, 255) !important;">
48558.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(189, 223, 38, 255) !important;">
55320.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(246, 230, 32, 255) !important;">
47558.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(200, 224, 32, 255) !important;">
51000.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(165, 219, 54, 255) !important;">
53500.00
</td>
</tr>
<tr>
<td style="text-align:right;">
2021
</td>
<td style="text-align:right;color: white !important;background-color: rgba(99, 203, 95, 255) !important;">
59270.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
55733.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(231, 228, 25, 255) !important;">
50300.00
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
48358.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
51308.33
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
49062.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
56441.67
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
47737.50
</td>
<td style="text-align:right;color: white !important;background-color: rgba(253, 231, 37, 255) !important;">
52195.83
</td>
<td style="text-align:right;color: white !important;background-color: rgba(149, 216, 64, 255) !important;">
53025.00
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="examining-crime-and-income-together" class="section level3">
<h3>Examining Crime and Income together</h3>
<p>After separately exploring the two data sets, there appears to be a
potential relationship between crime rate and income. However, further
experimentation using both data sets together is necessary to confirm
and understand this relationship more comprehensively.</p>
<pre class="r"><code>filtered_census &lt;- census_df %&gt;% filter(`Income source` == &quot;Total income&quot;) 
filtered_crime &lt;- crime_df %&gt;%filter(Violations==&quot;Total, all violations&quot;)

joint_df &lt;- inner_join(filtered_crime, filtered_census, by = c(&quot;REF_DATE&quot;, &quot;GEO&quot;))

ggplot(data = joint_df, aes(x = `Average income (excluding zeros)`, y = `Rate per 100,000 population`, color = GEO, size = 3)) +
  geom_point(alpha = 0.3) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE, size = 1.0) + 
  guides(size = FALSE) + # remove &quot;size&quot; from legend
  labs(x = &quot;Average Total Income (excluding zeros)&quot;, y = &quot;Total Crime Rate per 100,000 population`&quot;, title = &quot;Average Total Income and Total Crime Rate&quot;) +
  theme_linedraw() + 
  scale_color_discrete(name = &quot;Provinces&quot;) +
  theme(axis.text = element_text(size = 7)) +
  theme(plot.title = element_text(face = &quot;bold&quot;)) +
  theme(legend.title = element_text(face = &quot;bold&quot;)) +
  theme(plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), &quot;cm&quot;))</code></pre>
<p><img src="work_files/figure-html/unnamed-chunk-21-1.png" width="960" style="display: block; margin: auto;" />
The scatter plot presented demonstrates the relationship between average
total income and total crime rate (ignoring crime type). Although the
overall distribution of points may not reveal a strong relationship,
upon coloring the points by province, a distinct pattern emerges. It
becomes evident that average total income and total crime rate are
<strong>negatively correlated</strong> across all provinces, with
possibly the exception of Newfoundland and Labrador where the
relationship appears to be less pronounced, indicated by a line that is
nearly horizontal. To draw a confident conclusion, it is imperative to
examine the actual correlation value between these variables.</p>
<table class="table table-striped table" style="width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Correlation between Average Total Income and Total Crime Rate
</div>
</th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Province
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Correlation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Quebec
</td>
<td style="text-align:right;">
-0.9447648
</td>
</tr>
<tr>
<td style="text-align:left;">
Nova Scotia
</td>
<td style="text-align:right;">
-0.9236636
</td>
</tr>
<tr>
<td style="text-align:left;">
British Columbia
</td>
<td style="text-align:right;">
-0.8154907
</td>
</tr>
<tr>
<td style="text-align:left;">
Prince Edward Island
</td>
<td style="text-align:right;">
-0.8082244
</td>
</tr>
<tr>
<td style="text-align:left;">
Saskatchewan
</td>
<td style="text-align:right;">
-0.7695228
</td>
</tr>
<tr>
<td style="text-align:left;">
Ontario
</td>
<td style="text-align:right;">
-0.7583329
</td>
</tr>
<tr>
<td style="text-align:left;">
Manitoba
</td>
<td style="text-align:right;">
-0.7392303
</td>
</tr>
<tr>
<td style="text-align:left;">
Alberta
</td>
<td style="text-align:right;">
-0.7023852
</td>
</tr>
<tr>
<td style="text-align:left;">
New Brunswick
</td>
<td style="text-align:right;">
-0.5966958
</td>
</tr>
<tr>
<td style="text-align:left;">
Newfoundland and Labrador
</td>
<td style="text-align:right;">
-0.0025743
</td>
</tr>
</tbody>
</table>
<p>From here, we can see that all correlation values are less than zero,
which includes Newfoundland and Labrador which has a very week but
negative correlation. Quebec exhibits the strongest correlation between
average total income and total crime rate as the correlation is close to
-1.</p>
<p><img src="work_files/figure-html/unnamed-chunk-24-1.png" width="1440" style="display: block; margin: auto;" />
The three smaller plots investigate the relationship between a specific
income source and a particular type of violation, as indicated by the
legend. In the first plot, which examines the relationship between
<strong>robbery crime rate and employment income</strong>, all provinces
display a negative trend except for Newfoundland and Labrador. Manitoba
demonstrates a weak relationship, as evidenced by the considerable
dispersion of points around the line.</p>
<p>Moving to the second plot, which contrasts <strong>market income with
property crime rate</strong>, a strong and negative relationship is
apparent. The third plot, depicting <strong>employment income versus
prostitution crime rate</strong>, reveals varying degrees of association
across provinces, with many showing a weak relationship. Notably,
Ontario exhibits a positive relationship between employment income and
prostitution crime rate.</p>
</div>
<div id="pick-a-province-to-look-closer" class="section level3">
<h3>Pick a Province to Look Closer</h3>
<p>Since <strong>Ontario</strong> demonstrates a different relationship
to other provinces in the previous plot, I choose it to take a closer
look. The bar plot below shows the composition of crime incidents each
year in Ontario. We see that the major categories are <strong>property
crime</strong> and <strong>weapon violations</strong>.</p>
<p><img src="work_files/figure-html/unnamed-chunk-25-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p><img src="work_files/figure-html/unnamed-chunk-26-1.png" width="1440" style="display: block; margin: auto 0 auto auto;" /></p>
<p><img src="work_files/figure-html/unnamed-chunk-28-1.png" width="1920" /></p>
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<div
style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table" style="margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;" colspan="16">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Table of Average Total Income
</div>
</th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Violations
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Canada Pension Plan (CPP) and Quebec Pension Plan (QPP) benefits
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Child benefits
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Employment Insurance (EI) benefits
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Employment income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Government transfers
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Investment income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Market income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Old Age Security (OAS) and Guaranteed Income Supplement (GIS)
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Other government transfers
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Other income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Retirement income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Self-employment income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Social assistance
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Total income
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;position: sticky; top:0; background-color: #FFFFFF;">
Wages, salaries and commissions
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Total Cannabis Act
</td>
<td style="text-align:right;">
0.6399496
</td>
<td style="text-align:right;">
0.1543812
</td>
<td style="text-align:right;">
0.1797670
</td>
<td style="text-align:right;">
0.0753819
</td>
<td style="text-align:right;">
0.4470022
</td>
<td style="text-align:right;">
0.8532210
</td>
<td style="text-align:right;">
0.1175474
</td>
<td style="text-align:right;">
0.5881777
</td>
<td style="text-align:right;">
0.4757809
</td>
<td style="text-align:right;">
0.3878745
</td>
<td style="text-align:right;">
-0.3024679
</td>
<td style="text-align:right;">
0.7318504
</td>
<td style="text-align:right;">
-0.0331746
</td>
<td style="text-align:right;">
0.3492095
</td>
<td style="text-align:right;">
0.0793002
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Criminal Code traffic violations
</td>
<td style="text-align:right;">
-0.7186518
</td>
<td style="text-align:right;">
-0.7033720
</td>
<td style="text-align:right;">
-0.3111971
</td>
<td style="text-align:right;">
-0.8256471
</td>
<td style="text-align:right;">
-0.6259757
</td>
<td style="text-align:right;">
-0.7113270
</td>
<td style="text-align:right;">
-0.8392439
</td>
<td style="text-align:right;">
-0.7061295
</td>
<td style="text-align:right;">
-0.4641019
</td>
<td style="text-align:right;">
-0.6126601
</td>
<td style="text-align:right;">
-0.7662505
</td>
<td style="text-align:right;">
0.4119972
</td>
<td style="text-align:right;">
-0.2573561
</td>
<td style="text-align:right;">
-0.8091403
</td>
<td style="text-align:right;">
-0.8124589
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Federal Statute violations
</td>
<td style="text-align:right;">
-0.6119287
</td>
<td style="text-align:right;">
-0.7838763
</td>
<td style="text-align:right;">
-0.3673042
</td>
<td style="text-align:right;">
-0.7543371
</td>
<td style="text-align:right;">
-0.7932252
</td>
<td style="text-align:right;">
-0.7381556
</td>
<td style="text-align:right;">
-0.7753723
</td>
<td style="text-align:right;">
-0.6782687
</td>
<td style="text-align:right;">
-0.5159253
</td>
<td style="text-align:right;">
-0.6914845
</td>
<td style="text-align:right;">
-0.6938453
</td>
<td style="text-align:right;">
0.5508116
</td>
<td style="text-align:right;">
-0.4218109
</td>
<td style="text-align:right;">
-0.8030217
</td>
<td style="text-align:right;">
-0.7323180
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Immigration and Refugee Protection Act
</td>
<td style="text-align:right;">
-0.8317978
</td>
<td style="text-align:right;">
-0.7728983
</td>
<td style="text-align:right;">
-0.4672506
</td>
<td style="text-align:right;">
-0.6495341
</td>
<td style="text-align:right;">
-0.6644657
</td>
<td style="text-align:right;">
-0.7653287
</td>
<td style="text-align:right;">
-0.7071820
</td>
<td style="text-align:right;">
-0.8112917
</td>
<td style="text-align:right;">
-0.6886685
</td>
<td style="text-align:right;">
-0.4842990
</td>
<td style="text-align:right;">
-0.7879141
</td>
<td style="text-align:right;">
0.7048638
</td>
<td style="text-align:right;">
-0.7783455
</td>
<td style="text-align:right;">
-0.7171724
</td>
<td style="text-align:right;">
-0.6634925
</td>
</tr>
<tr>
<td style="text-align:left;">
Total abduction
</td>
<td style="text-align:right;">
-0.8040213
</td>
<td style="text-align:right;">
-0.7333317
</td>
<td style="text-align:right;">
-0.4912742
</td>
<td style="text-align:right;">
-0.8052992
</td>
<td style="text-align:right;">
-0.6300930
</td>
<td style="text-align:right;">
-0.6951519
</td>
<td style="text-align:right;">
-0.8119927
</td>
<td style="text-align:right;">
-0.7372497
</td>
<td style="text-align:right;">
-0.5562309
</td>
<td style="text-align:right;">
-0.6732663
</td>
<td style="text-align:right;">
-0.7985790
</td>
<td style="text-align:right;">
0.4697212
</td>
<td style="text-align:right;">
-0.4617595
</td>
<td style="text-align:right;">
-0.7891757
</td>
<td style="text-align:right;">
-0.8045523
</td>
</tr>
<tr>
<td style="text-align:left;">
Total administration of justice violations
</td>
<td style="text-align:right;">
0.2894308
</td>
<td style="text-align:right;">
0.5634451
</td>
<td style="text-align:right;">
0.0545464
</td>
<td style="text-align:right;">
0.5244904
</td>
<td style="text-align:right;">
0.3645871
</td>
<td style="text-align:right;">
0.3851740
</td>
<td style="text-align:right;">
0.5142525
</td>
<td style="text-align:right;">
0.4384029
</td>
<td style="text-align:right;">
0.2325288
</td>
<td style="text-align:right;">
0.5417441
</td>
<td style="text-align:right;">
0.3120033
</td>
<td style="text-align:right;">
-0.3465106
</td>
<td style="text-align:right;">
0.2938743
</td>
<td style="text-align:right;">
0.4909069
</td>
<td style="text-align:right;">
0.5033958
</td>
</tr>
<tr>
<td style="text-align:left;">
Total assaults against a peace officer
</td>
<td style="text-align:right;">
0.5502388
</td>
<td style="text-align:right;">
0.6390806
</td>
<td style="text-align:right;">
0.5288927
</td>
<td style="text-align:right;">
0.6454176
</td>
<td style="text-align:right;">
0.6027397
</td>
<td style="text-align:right;">
0.4865436
</td>
<td style="text-align:right;">
0.6319311
</td>
<td style="text-align:right;">
0.5931247
</td>
<td style="text-align:right;">
0.7434956
</td>
<td style="text-align:right;">
0.6854612
</td>
<td style="text-align:right;">
0.4739395
</td>
<td style="text-align:right;">
-0.2753145
</td>
<td style="text-align:right;">
0.2414854
</td>
<td style="text-align:right;">
0.6431781
</td>
<td style="text-align:right;">
0.6085258
</td>
</tr>
<tr>
<td style="text-align:left;">
Total breaking and entering
</td>
<td style="text-align:right;">
-0.9225065
</td>
<td style="text-align:right;">
-0.8356442
</td>
<td style="text-align:right;">
-0.4924572
</td>
<td style="text-align:right;">
-0.8626247
</td>
<td style="text-align:right;">
-0.7424577
</td>
<td style="text-align:right;">
-0.8514282
</td>
<td style="text-align:right;">
-0.8942464
</td>
<td style="text-align:right;">
-0.8359850
</td>
<td style="text-align:right;">
-0.6090103
</td>
<td style="text-align:right;">
-0.6813438
</td>
<td style="text-align:right;">
-0.9195154
</td>
<td style="text-align:right;">
0.6695426
</td>
<td style="text-align:right;">
-0.6051515
</td>
<td style="text-align:right;">
-0.8816448
</td>
<td style="text-align:right;">
-0.8744406
</td>
</tr>
<tr>
<td style="text-align:left;">
Total cannabis, trafficking, production or distribution
(pre-legalization)
</td>
<td style="text-align:right;">
-0.8042443
</td>
<td style="text-align:right;">
-0.7928160
</td>
<td style="text-align:right;">
-0.2177518
</td>
<td style="text-align:right;">
-0.8090668
</td>
<td style="text-align:right;">
-0.7933560
</td>
<td style="text-align:right;">
-0.7772350
</td>
<td style="text-align:right;">
-0.8522811
</td>
<td style="text-align:right;">
-0.7282460
</td>
<td style="text-align:right;">
-0.2614858
</td>
<td style="text-align:right;">
-0.5575754
</td>
<td style="text-align:right;">
-0.8674750
</td>
<td style="text-align:right;">
0.5659155
</td>
<td style="text-align:right;">
-0.6541342
</td>
<td style="text-align:right;">
-0.8558468
</td>
<td style="text-align:right;">
-0.8056268
</td>
</tr>
<tr>
<td style="text-align:left;">
Total cocaine, trafficking, production or distribution
</td>
<td style="text-align:right;">
0.0080186
</td>
<td style="text-align:right;">
-0.0443540
</td>
<td style="text-align:right;">
0.1815189
</td>
<td style="text-align:right;">
0.0002429
</td>
<td style="text-align:right;">
-0.0576558
</td>
<td style="text-align:right;">
-0.0816744
</td>
<td style="text-align:right;">
0.0032864
</td>
<td style="text-align:right;">
-0.0408692
</td>
<td style="text-align:right;">
0.0252626
</td>
<td style="text-align:right;">
0.2132940
</td>
<td style="text-align:right;">
-0.0442931
</td>
<td style="text-align:right;">
0.0848983
</td>
<td style="text-align:right;">
-0.1543917
</td>
<td style="text-align:right;">
-0.0123439
</td>
<td style="text-align:right;">
-0.0202027
</td>
</tr>
<tr>
<td style="text-align:left;">
Total distribution - Cannabis Act
</td>
<td style="text-align:right;">
0.2532874
</td>
<td style="text-align:right;">
0.3697878
</td>
<td style="text-align:right;">
0.4186719
</td>
<td style="text-align:right;">
0.2564310
</td>
<td style="text-align:right;">
0.7846734
</td>
<td style="text-align:right;">
0.8875198
</td>
<td style="text-align:right;">
0.3338212
</td>
<td style="text-align:right;">
0.8638276
</td>
<td style="text-align:right;">
0.5252365
</td>
<td style="text-align:right;">
0.5014931
</td>
<td style="text-align:right;">
-0.1813740
</td>
<td style="text-align:right;">
0.4965440
</td>
<td style="text-align:right;">
-0.3997706
</td>
<td style="text-align:right;">
0.6914302
</td>
<td style="text-align:right;">
0.2530735
</td>
</tr>
<tr>
<td style="text-align:left;">
Total drug violations
</td>
<td style="text-align:right;">
-0.3430541
</td>
<td style="text-align:right;">
-0.5827351
</td>
<td style="text-align:right;">
-0.2779386
</td>
<td style="text-align:right;">
-0.5463706
</td>
<td style="text-align:right;">
-0.6396933
</td>
<td style="text-align:right;">
-0.5269176
</td>
<td style="text-align:right;">
-0.5575712
</td>
<td style="text-align:right;">
-0.4479062
</td>
<td style="text-align:right;">
-0.3701146
</td>
<td style="text-align:right;">
-0.5511335
</td>
<td style="text-align:right;">
-0.4286892
</td>
<td style="text-align:right;">
0.3378455
</td>
<td style="text-align:right;">
-0.2088664
</td>
<td style="text-align:right;">
-0.5953362
</td>
<td style="text-align:right;">
-0.5170650
</td>
</tr>
<tr>
<td style="text-align:left;">
Total fail to stop or remain
</td>
<td style="text-align:right;">
-0.4034206
</td>
<td style="text-align:right;">
-0.5030218
</td>
<td style="text-align:right;">
-0.2803077
</td>
<td style="text-align:right;">
-0.6386394
</td>
<td style="text-align:right;">
-0.5070987
</td>
<td style="text-align:right;">
-0.4955722
</td>
<td style="text-align:right;">
-0.6375927
</td>
<td style="text-align:right;">
-0.4195422
</td>
<td style="text-align:right;">
-0.3208439
</td>
<td style="text-align:right;">
-0.5573177
</td>
<td style="text-align:right;">
-0.4472545
</td>
<td style="text-align:right;">
0.1577972
</td>
<td style="text-align:right;">
0.1608018
</td>
<td style="text-align:right;">
-0.6228607
</td>
<td style="text-align:right;">
-0.6104423
</td>
</tr>
<tr>
<td style="text-align:left;">
Total firearms, use of, discharge, pointing
</td>
<td style="text-align:right;">
0.4841041
</td>
<td style="text-align:right;">
0.7126655
</td>
<td style="text-align:right;">
0.3222550
</td>
<td style="text-align:right;">
0.7080560
</td>
<td style="text-align:right;">
0.7362454
</td>
<td style="text-align:right;">
0.6864169
</td>
<td style="text-align:right;">
0.7176776
</td>
<td style="text-align:right;">
0.5769022
</td>
<td style="text-align:right;">
0.5186607
</td>
<td style="text-align:right;">
0.6327615
</td>
<td style="text-align:right;">
0.5410733
</td>
<td style="text-align:right;">
-0.4276664
</td>
<td style="text-align:right;">
0.1780762
</td>
<td style="text-align:right;">
0.7437977
</td>
<td style="text-align:right;">
0.6955827
</td>
</tr>
<tr>
<td style="text-align:left;">
Total forcible confinement or kidnapping
</td>
<td style="text-align:right;">
-0.0720063
</td>
<td style="text-align:right;">
0.0112625
</td>
<td style="text-align:right;">
0.1985305
</td>
<td style="text-align:right;">
0.0983675
</td>
<td style="text-align:right;">
-0.0452937
</td>
<td style="text-align:right;">
-0.1057013
</td>
<td style="text-align:right;">
0.0631279
</td>
<td style="text-align:right;">
-0.0020276
</td>
<td style="text-align:right;">
0.0240264
</td>
<td style="text-align:right;">
0.3024561
</td>
<td style="text-align:right;">
-0.0950879
</td>
<td style="text-align:right;">
0.2446965
</td>
<td style="text-align:right;">
-0.2214532
</td>
<td style="text-align:right;">
0.0370225
</td>
<td style="text-align:right;">
0.0638929
</td>
</tr>
<tr>
<td style="text-align:left;">
Total impaired driving
</td>
<td style="text-align:right;">
-0.8557310
</td>
<td style="text-align:right;">
-0.7818825
</td>
<td style="text-align:right;">
-0.3409620
</td>
<td style="text-align:right;">
-0.8188966
</td>
<td style="text-align:right;">
-0.6783186
</td>
<td style="text-align:right;">
-0.7761839
</td>
<td style="text-align:right;">
-0.8456043
</td>
<td style="text-align:right;">
-0.8438246
</td>
<td style="text-align:right;">
-0.5720862
</td>
<td style="text-align:right;">
-0.5889177
</td>
<td style="text-align:right;">
-0.8976395
</td>
<td style="text-align:right;">
0.6189236
</td>
<td style="text-align:right;">
-0.6575261
</td>
<td style="text-align:right;">
-0.8275574
</td>
<td style="text-align:right;">
-0.8216312
</td>
</tr>
<tr>
<td style="text-align:left;">
Total importation and exportation - Cannabis Act
</td>
<td style="text-align:right;">
0.6767907
</td>
<td style="text-align:right;">
0.1838120
</td>
<td style="text-align:right;">
0.2046896
</td>
<td style="text-align:right;">
0.1116378
</td>
<td style="text-align:right;">
0.4052830
</td>
<td style="text-align:right;">
0.8176372
</td>
<td style="text-align:right;">
0.1478339
</td>
<td style="text-align:right;">
0.5465302
</td>
<td style="text-align:right;">
0.4199046
</td>
<td style="text-align:right;">
0.4234147
</td>
<td style="text-align:right;">
-0.3605503
</td>
<td style="text-align:right;">
0.7744642
</td>
<td style="text-align:right;">
-0.0363785
</td>
<td style="text-align:right;">
0.3419987
</td>
<td style="text-align:right;">
0.1164391
</td>
</tr>
<tr>
<td style="text-align:left;">
Total mischief
</td>
<td style="text-align:right;">
-0.9421800
</td>
<td style="text-align:right;">
-0.8471372
</td>
<td style="text-align:right;">
-0.3820440
</td>
<td style="text-align:right;">
-0.8534749
</td>
<td style="text-align:right;">
-0.7563984
</td>
<td style="text-align:right;">
-0.8918294
</td>
<td style="text-align:right;">
-0.8895470
</td>
<td style="text-align:right;">
-0.8566592
</td>
<td style="text-align:right;">
-0.6105450
</td>
<td style="text-align:right;">
-0.5876269
</td>
<td style="text-align:right;">
-0.9529915
</td>
<td style="text-align:right;">
0.7451827
</td>
<td style="text-align:right;">
-0.7189232
</td>
<td style="text-align:right;">
-0.8816163
</td>
<td style="text-align:right;">
-0.8709267
</td>
</tr>
<tr>
<td style="text-align:left;">
Total offences in relation to sexual services
</td>
<td style="text-align:right;">
0.1489431
</td>
<td style="text-align:right;">
0.0213727
</td>
<td style="text-align:right;">
-0.4663334
</td>
<td style="text-align:right;">
0.0241671
</td>
<td style="text-align:right;">
-0.3243725
</td>
<td style="text-align:right;">
-0.1657629
</td>
<td style="text-align:right;">
0.0339013
</td>
<td style="text-align:right;">
0.5777400
</td>
<td style="text-align:right;">
0.0346752
</td>
<td style="text-align:right;">
-0.1125754
</td>
<td style="text-align:right;">
0.0358541
</td>
<td style="text-align:right;">
-0.5972165
</td>
<td style="text-align:right;">
0.6151757
</td>
<td style="text-align:right;">
-0.1268857
</td>
<td style="text-align:right;">
0.0749833
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other Controlled Drugs and Substances Act drugs, trafficking,
production or distribution
</td>
<td style="text-align:right;">
0.6495872
</td>
<td style="text-align:right;">
0.6406151
</td>
<td style="text-align:right;">
0.6388294
</td>
<td style="text-align:right;">
0.7081229
</td>
<td style="text-align:right;">
0.6977985
</td>
<td style="text-align:right;">
0.6213830
</td>
<td style="text-align:right;">
0.7108679
</td>
<td style="text-align:right;">
0.6006871
</td>
<td style="text-align:right;">
0.6900359
</td>
<td style="text-align:right;">
0.6663725
</td>
<td style="text-align:right;">
0.6454468
</td>
<td style="text-align:right;">
-0.3011561
</td>
<td style="text-align:right;">
0.1776899
</td>
<td style="text-align:right;">
0.7286213
</td>
<td style="text-align:right;">
0.7085948
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other Criminal Code traffic violations
</td>
<td style="text-align:right;">
-0.3874440
</td>
<td style="text-align:right;">
-0.4263617
</td>
<td style="text-align:right;">
-0.1928496
</td>
<td style="text-align:right;">
-0.5842861
</td>
<td style="text-align:right;">
-0.3942984
</td>
<td style="text-align:right;">
-0.4435046
</td>
<td style="text-align:right;">
-0.5827052
</td>
<td style="text-align:right;">
-0.3781473
</td>
<td style="text-align:right;">
-0.2337219
</td>
<td style="text-align:right;">
-0.4494342
</td>
<td style="text-align:right;">
-0.4256197
</td>
<td style="text-align:right;">
0.1133769
</td>
<td style="text-align:right;">
0.1587207
</td>
<td style="text-align:right;">
-0.5513948
</td>
<td style="text-align:right;">
-0.5615534
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other Criminal Code violations
</td>
<td style="text-align:right;">
-0.4582604
</td>
<td style="text-align:right;">
-0.1970822
</td>
<td style="text-align:right;">
-0.2703928
</td>
<td style="text-align:right;">
-0.3107493
</td>
<td style="text-align:right;">
-0.2131728
</td>
<td style="text-align:right;">
-0.3098238
</td>
<td style="text-align:right;">
-0.3272181
</td>
<td style="text-align:right;">
-0.2927299
</td>
<td style="text-align:right;">
-0.2581102
</td>
<td style="text-align:right;">
-0.1374758
</td>
<td style="text-align:right;">
-0.4353647
</td>
<td style="text-align:right;">
0.1195234
</td>
<td style="text-align:right;">
-0.1448995
</td>
<td style="text-align:right;">
-0.3075077
</td>
<td style="text-align:right;">
-0.3212000
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other Federal Statutes
</td>
<td style="text-align:right;">
-0.5031877
</td>
<td style="text-align:right;">
-0.4959433
</td>
<td style="text-align:right;">
-0.1536789
</td>
<td style="text-align:right;">
-0.4251374
</td>
<td style="text-align:right;">
-0.5025090
</td>
<td style="text-align:right;">
-0.4955586
</td>
<td style="text-align:right;">
-0.4627664
</td>
<td style="text-align:right;">
-0.5004846
</td>
<td style="text-align:right;">
-0.3190501
</td>
<td style="text-align:right;">
-0.2850063
</td>
<td style="text-align:right;">
-0.5950219
</td>
<td style="text-align:right;">
0.5122293
</td>
<td style="text-align:right;">
-0.5006676
</td>
<td style="text-align:right;">
-0.4867740
</td>
<td style="text-align:right;">
-0.4229529
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other assaults
</td>
<td style="text-align:right;">
-0.7774742
</td>
<td style="text-align:right;">
-0.8203756
</td>
<td style="text-align:right;">
-0.3529050
</td>
<td style="text-align:right;">
-0.8408717
</td>
<td style="text-align:right;">
-0.7923596
</td>
<td style="text-align:right;">
-0.8219512
</td>
<td style="text-align:right;">
-0.8592494
</td>
<td style="text-align:right;">
-0.7914887
</td>
<td style="text-align:right;">
-0.5078342
</td>
<td style="text-align:right;">
-0.5963271
</td>
<td style="text-align:right;">
-0.8563039
</td>
<td style="text-align:right;">
0.6342825
</td>
<td style="text-align:right;">
-0.5585913
</td>
<td style="text-align:right;">
-0.8675191
</td>
<td style="text-align:right;">
-0.8394781
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other violations
</td>
<td style="text-align:right;">
-0.6948372
</td>
<td style="text-align:right;">
-0.6049911
</td>
<td style="text-align:right;">
-0.3362882
</td>
<td style="text-align:right;">
-0.7393387
</td>
<td style="text-align:right;">
-0.4829557
</td>
<td style="text-align:right;">
-0.6199522
</td>
<td style="text-align:right;">
-0.7453292
</td>
<td style="text-align:right;">
-0.6079443
</td>
<td style="text-align:right;">
-0.4412007
</td>
<td style="text-align:right;">
-0.5557644
</td>
<td style="text-align:right;">
-0.6815783
</td>
<td style="text-align:right;">
0.3165638
</td>
<td style="text-align:right;">
-0.2428936
</td>
<td style="text-align:right;">
-0.6997612
</td>
<td style="text-align:right;">
-0.7285573
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other violations causing death
</td>
<td style="text-align:right;">
-0.7013575
</td>
<td style="text-align:right;">
-0.5561567
</td>
<td style="text-align:right;">
-0.4128154
</td>
<td style="text-align:right;">
-0.5330036
</td>
<td style="text-align:right;">
-0.5441578
</td>
<td style="text-align:right;">
-0.6001823
</td>
<td style="text-align:right;">
-0.5702280
</td>
<td style="text-align:right;">
-0.6020835
</td>
<td style="text-align:right;">
-0.5816201
</td>
<td style="text-align:right;">
-0.4667281
</td>
<td style="text-align:right;">
-0.5995986
</td>
<td style="text-align:right;">
0.4220517
</td>
<td style="text-align:right;">
-0.5101842
</td>
<td style="text-align:right;">
-0.5804457
</td>
<td style="text-align:right;">
-0.5177336
</td>
</tr>
<tr>
<td style="text-align:left;">
Total other violent violations
</td>
<td style="text-align:right;">
0.6964391
</td>
<td style="text-align:right;">
0.7813993
</td>
<td style="text-align:right;">
0.2698997
</td>
<td style="text-align:right;">
0.6861032
</td>
<td style="text-align:right;">
0.7566179
</td>
<td style="text-align:right;">
0.7006098
</td>
<td style="text-align:right;">
0.7205615
</td>
<td style="text-align:right;">
0.7710238
</td>
<td style="text-align:right;">
0.5678581
</td>
<td style="text-align:right;">
0.5599879
</td>
<td style="text-align:right;">
0.7078508
</td>
<td style="text-align:right;">
-0.7407048
</td>
<td style="text-align:right;">
0.5774332
</td>
<td style="text-align:right;">
0.7512794
</td>
<td style="text-align:right;">
0.7146516
</td>
</tr>
<tr>
<td style="text-align:left;">
Total possession - Cannabis Act
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Total possession of stolen property
</td>
<td style="text-align:right;">
-0.8196812
</td>
<td style="text-align:right;">
-0.7026968
</td>
<td style="text-align:right;">
-0.2209310
</td>
<td style="text-align:right;">
-0.7205022
</td>
<td style="text-align:right;">
-0.6337884
</td>
<td style="text-align:right;">
-0.8151877
</td>
<td style="text-align:right;">
-0.7595498
</td>
<td style="text-align:right;">
-0.6951892
</td>
<td style="text-align:right;">
-0.4070943
</td>
<td style="text-align:right;">
-0.4134656
</td>
<td style="text-align:right;">
-0.8648735
</td>
<td style="text-align:right;">
0.7192309
</td>
<td style="text-align:right;">
-0.6326056
</td>
<td style="text-align:right;">
-0.7496622
</td>
<td style="text-align:right;">
-0.7671210
</td>
</tr>
<tr>
<td style="text-align:left;">
Total production - Cannabis Act
</td>
<td style="text-align:right;">
-0.7823286
</td>
<td style="text-align:right;">
-0.3321634
</td>
<td style="text-align:right;">
-0.2575272
</td>
<td style="text-align:right;">
-0.4347831
</td>
<td style="text-align:right;">
0.8863796
</td>
<td style="text-align:right;">
0.8552884
</td>
<td style="text-align:right;">
-0.3390936
</td>
<td style="text-align:right;">
0.9509705
</td>
<td style="text-align:right;">
0.8444271
</td>
<td style="text-align:right;">
-0.5354741
</td>
<td style="text-align:right;">
0.9226652
</td>
<td style="text-align:right;">
-0.9901246
</td>
<td style="text-align:right;">
-0.1265695
</td>
<td style="text-align:right;">
0.3094884
</td>
<td style="text-align:right;">
-0.4511187
</td>
</tr>
<tr>
<td style="text-align:left;">
Total property crime violations
</td>
<td style="text-align:right;">
-0.8978577
</td>
<td style="text-align:right;">
-0.7543288
</td>
<td style="text-align:right;">
-0.4203821
</td>
<td style="text-align:right;">
-0.7746335
</td>
<td style="text-align:right;">
-0.6737176
</td>
<td style="text-align:right;">
-0.8114778
</td>
<td style="text-align:right;">
-0.8121705
</td>
<td style="text-align:right;">
-0.7934432
</td>
<td style="text-align:right;">
-0.5476628
</td>
<td style="text-align:right;">
-0.5366632
</td>
<td style="text-align:right;">
-0.8962551
</td>
<td style="text-align:right;">
0.6683060
</td>
<td style="text-align:right;">
-0.6368281
</td>
<td style="text-align:right;">
-0.8005713
</td>
<td style="text-align:right;">
-0.7949070
</td>
</tr>
<tr>
<td style="text-align:left;">
Total prostitution
</td>
<td style="text-align:right;">
-0.8489033
</td>
<td style="text-align:right;">
-0.7559321
</td>
<td style="text-align:right;">
-0.5186475
</td>
<td style="text-align:right;">
-0.9180496
</td>
<td style="text-align:right;">
-0.7359056
</td>
<td style="text-align:right;">
-0.7157644
</td>
<td style="text-align:right;">
-0.9652457
</td>
<td style="text-align:right;">
-0.6890291
</td>
<td style="text-align:right;">
-0.5180918
</td>
<td style="text-align:right;">
-0.5513721
</td>
<td style="text-align:right;">
-0.8177643
</td>
<td style="text-align:right;">
0.2252633
</td>
<td style="text-align:right;">
-0.2280487
</td>
<td style="text-align:right;">
-0.9558729
</td>
<td style="text-align:right;">
-0.9036327
</td>
</tr>
<tr>
<td style="text-align:left;">
Total robbery
</td>
<td style="text-align:right;">
-0.5709575
</td>
<td style="text-align:right;">
-0.6007255
</td>
<td style="text-align:right;">
-0.2973412
</td>
<td style="text-align:right;">
-0.6191589
</td>
<td style="text-align:right;">
-0.6429332
</td>
<td style="text-align:right;">
-0.6640692
</td>
<td style="text-align:right;">
-0.6398530
</td>
<td style="text-align:right;">
-0.5423024
</td>
<td style="text-align:right;">
-0.3066751
</td>
<td style="text-align:right;">
-0.3943991
</td>
<td style="text-align:right;">
-0.6745697
</td>
<td style="text-align:right;">
0.5084582
</td>
<td style="text-align:right;">
-0.3464958
</td>
<td style="text-align:right;">
-0.6596610
</td>
<td style="text-align:right;">
-0.6230131
</td>
</tr>
<tr>
<td style="text-align:left;">
Total sale - Cannabis Act
</td>
<td style="text-align:right;">
0.8305721
</td>
<td style="text-align:right;">
-0.1995422
</td>
<td style="text-align:right;">
-0.1936661
</td>
<td style="text-align:right;">
-0.2414690
</td>
<td style="text-align:right;">
0.0859602
</td>
<td style="text-align:right;">
0.7246261
</td>
<td style="text-align:right;">
-0.2315929
</td>
<td style="text-align:right;">
0.2651273
</td>
<td style="text-align:right;">
0.4681703
</td>
<td style="text-align:right;">
0.0796278
</td>
<td style="text-align:right;">
-0.2133301
</td>
<td style="text-align:right;">
0.7179241
</td>
<td style="text-align:right;">
0.3914490
</td>
<td style="text-align:right;">
-0.0892274
</td>
<td style="text-align:right;">
-0.2326984
</td>
</tr>
<tr>
<td style="text-align:left;">
Total sexual violations against children
</td>
<td style="text-align:right;">
0.8340545
</td>
<td style="text-align:right;">
0.9631761
</td>
<td style="text-align:right;">
0.4861737
</td>
<td style="text-align:right;">
0.9038366
</td>
<td style="text-align:right;">
0.8848393
</td>
<td style="text-align:right;">
0.8979768
</td>
<td style="text-align:right;">
0.9343577
</td>
<td style="text-align:right;">
0.8850667
</td>
<td style="text-align:right;">
0.6683254
</td>
<td style="text-align:right;">
0.7698027
</td>
<td style="text-align:right;">
0.8622806
</td>
<td style="text-align:right;">
-0.7587430
</td>
<td style="text-align:right;">
0.6418588
</td>
<td style="text-align:right;">
0.9493437
</td>
<td style="text-align:right;">
0.9126578
</td>
</tr>
<tr>
<td style="text-align:left;">
Total theft of motor vehicle
</td>
<td style="text-align:right;">
-0.8934673
</td>
<td style="text-align:right;">
-0.7086737
</td>
<td style="text-align:right;">
-0.3710112
</td>
<td style="text-align:right;">
-0.6914095
</td>
<td style="text-align:right;">
-0.6038020
</td>
<td style="text-align:right;">
-0.7685217
</td>
<td style="text-align:right;">
-0.7373869
</td>
<td style="text-align:right;">
-0.7760287
</td>
<td style="text-align:right;">
-0.5825151
</td>
<td style="text-align:right;">
-0.4755032
</td>
<td style="text-align:right;">
-0.8544672
</td>
<td style="text-align:right;">
0.6865498
</td>
<td style="text-align:right;">
-0.7347073
</td>
<td style="text-align:right;">
-0.7248222
</td>
<td style="text-align:right;">
-0.7254220
</td>
</tr>
<tr>
<td style="text-align:left;">
Total theft over $5,000 (non-motor vehicle)
</td>
<td style="text-align:right;">
-0.6491545
</td>
<td style="text-align:right;">
-0.4225805
</td>
<td style="text-align:right;">
-0.3014013
</td>
<td style="text-align:right;">
-0.4782235
</td>
<td style="text-align:right;">
-0.3342665
</td>
<td style="text-align:right;">
-0.4653237
</td>
<td style="text-align:right;">
-0.4965087
</td>
<td style="text-align:right;">
-0.5338034
</td>
<td style="text-align:right;">
-0.3649756
</td>
<td style="text-align:right;">
-0.3222718
</td>
<td style="text-align:right;">
-0.6086177
</td>
<td style="text-align:right;">
0.3643097
</td>
<td style="text-align:right;">
-0.4855605
</td>
<td style="text-align:right;">
-0.4693896
</td>
<td style="text-align:right;">
-0.4890690
</td>
</tr>
<tr>
<td style="text-align:left;">
Total theft under $5,000 (non-motor vehicle)
</td>
<td style="text-align:right;">
-0.8094329
</td>
<td style="text-align:right;">
-0.7399273
</td>
<td style="text-align:right;">
-0.4824113
</td>
<td style="text-align:right;">
-0.7709340
</td>
<td style="text-align:right;">
-0.7138874
</td>
<td style="text-align:right;">
-0.7738704
</td>
<td style="text-align:right;">
-0.8009891
</td>
<td style="text-align:right;">
-0.7576249
</td>
<td style="text-align:right;">
-0.5158623
</td>
<td style="text-align:right;">
-0.5842126
</td>
<td style="text-align:right;">
-0.8346564
</td>
<td style="text-align:right;">
0.5971284
</td>
<td style="text-align:right;">
-0.4862269
</td>
<td style="text-align:right;">
-0.8023110
</td>
<td style="text-align:right;">
-0.7757068
</td>
</tr>
<tr>
<td style="text-align:left;">
Total trafficking in stolen property
</td>
<td style="text-align:right;">
0.8607122
</td>
<td style="text-align:right;">
0.8837019
</td>
<td style="text-align:right;">
0.3888328
</td>
<td style="text-align:right;">
0.8627692
</td>
<td style="text-align:right;">
0.8116025
</td>
<td style="text-align:right;">
0.9082499
</td>
<td style="text-align:right;">
0.9003260
</td>
<td style="text-align:right;">
0.8123087
</td>
<td style="text-align:right;">
0.5383496
</td>
<td style="text-align:right;">
0.6748250
</td>
<td style="text-align:right;">
0.9082349
</td>
<td style="text-align:right;">
-0.7849822
</td>
<td style="text-align:right;">
0.6359333
</td>
<td style="text-align:right;">
0.9041812
</td>
<td style="text-align:right;">
0.8854195
</td>
</tr>
<tr>
<td style="text-align:left;">
Total violent Criminal Code violations
</td>
<td style="text-align:right;">
-0.6680451
</td>
<td style="text-align:right;">
-0.4037117
</td>
<td style="text-align:right;">
-0.1343821
</td>
<td style="text-align:right;">
-0.3982306
</td>
<td style="text-align:right;">
-0.3211282
</td>
<td style="text-align:right;">
-0.5137263
</td>
<td style="text-align:right;">
-0.4445947
</td>
<td style="text-align:right;">
-0.5525946
</td>
<td style="text-align:right;">
-0.2576917
</td>
<td style="text-align:right;">
-0.1123500
</td>
<td style="text-align:right;">
-0.6785080
</td>
<td style="text-align:right;">
0.5155067
</td>
<td style="text-align:right;">
-0.7056360
</td>
<td style="text-align:right;">
-0.4259395
</td>
<td style="text-align:right;">
-0.4327636
</td>
</tr>
<tr>
<td style="text-align:left;">
Total weapons violations
</td>
<td style="text-align:right;">
-0.5488710
</td>
<td style="text-align:right;">
-0.2894091
</td>
<td style="text-align:right;">
-0.1254973
</td>
<td style="text-align:right;">
-0.4402386
</td>
<td style="text-align:right;">
-0.1719470
</td>
<td style="text-align:right;">
-0.4010723
</td>
<td style="text-align:right;">
-0.4336278
</td>
<td style="text-align:right;">
-0.3638832
</td>
<td style="text-align:right;">
-0.2474038
</td>
<td style="text-align:right;">
-0.1334781
</td>
<td style="text-align:right;">
-0.5087586
</td>
<td style="text-align:right;">
0.1434243
</td>
<td style="text-align:right;">
-0.2617335
</td>
<td style="text-align:right;">
-0.3789758
</td>
<td style="text-align:right;">
-0.4719344
</td>
</tr>
<tr>
<td style="text-align:left;">
Total, all Criminal Code violations (excluding traffic)
</td>
<td style="text-align:right;">
-0.8604485
</td>
<td style="text-align:right;">
-0.6786744
</td>
<td style="text-align:right;">
-0.3832652
</td>
<td style="text-align:right;">
-0.7068606
</td>
<td style="text-align:right;">
-0.6046292
</td>
<td style="text-align:right;">
-0.7527368
</td>
<td style="text-align:right;">
-0.7452086
</td>
<td style="text-align:right;">
-0.7421601
</td>
<td style="text-align:right;">
-0.5006376
</td>
<td style="text-align:right;">
-0.4571058
</td>
<td style="text-align:right;">
-0.8581022
</td>
<td style="text-align:right;">
0.6179758
</td>
<td style="text-align:right;">
-0.6235580
</td>
<td style="text-align:right;">
-0.7310706
</td>
<td style="text-align:right;">
-0.7291286
</td>
</tr>
<tr>
<td style="text-align:left;">
Total, all Criminal Code violations (including traffic)
</td>
<td style="text-align:right;">
-0.8634277
</td>
<td style="text-align:right;">
-0.6877659
</td>
<td style="text-align:right;">
-0.3841524
</td>
<td style="text-align:right;">
-0.7209247
</td>
<td style="text-align:right;">
-0.6126964
</td>
<td style="text-align:right;">
-0.7594233
</td>
<td style="text-align:right;">
-0.7584953
</td>
<td style="text-align:right;">
-0.7489895
</td>
<td style="text-align:right;">
-0.5046405
</td>
<td style="text-align:right;">
-0.4700883
</td>
<td style="text-align:right;">
-0.8635202
</td>
<td style="text-align:right;">
0.6149735
</td>
<td style="text-align:right;">
-0.6127094
</td>
<td style="text-align:right;">
-0.7434050
</td>
<td style="text-align:right;">
-0.7417003
</td>
</tr>
<tr>
<td style="text-align:left;">
Total, all violations
</td>
<td style="text-align:right;">
-0.8875784
</td>
<td style="text-align:right;">
-0.7308819
</td>
<td style="text-align:right;">
-0.4025536
</td>
<td style="text-align:right;">
-0.7606958
</td>
<td style="text-align:right;">
-0.6587512
</td>
<td style="text-align:right;">
-0.7967699
</td>
<td style="text-align:right;">
-0.7988669
</td>
<td style="text-align:right;">
-0.7818161
</td>
<td style="text-align:right;">
-0.5315050
</td>
<td style="text-align:right;">
-0.5121003
</td>
<td style="text-align:right;">
-0.8942667
</td>
<td style="text-align:right;">
0.6414355
</td>
<td style="text-align:right;">
-0.6288462
</td>
<td style="text-align:right;">
-0.7864432
</td>
<td style="text-align:right;">
-0.7790928
</td>
</tr>
<tr>
<td style="text-align:left;">
Total, possession, other Controlled Drugs and Substances Act drugs
</td>
<td style="text-align:right;">
0.8702986
</td>
<td style="text-align:right;">
0.9371958
</td>
<td style="text-align:right;">
0.5100074
</td>
<td style="text-align:right;">
0.9443876
</td>
<td style="text-align:right;">
0.9041758
</td>
<td style="text-align:right;">
0.8971434
</td>
<td style="text-align:right;">
0.9676695
</td>
<td style="text-align:right;">
0.8962826
</td>
<td style="text-align:right;">
0.7001886
</td>
<td style="text-align:right;">
0.8034666
</td>
<td style="text-align:right;">
0.9170933
</td>
<td style="text-align:right;">
-0.7102608
</td>
<td style="text-align:right;">
0.5627222
</td>
<td style="text-align:right;">
0.9800383
</td>
<td style="text-align:right;">
0.9418946
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table provides a summary of the <strong>correlation</strong>
between <strong>all types of violations and income sources in
Ontario</strong>. Notably, COVID-19 benefits are excluded from the
analysis due to their availability only during the pandemic years, which
limits the dataset. The strongest correlation is observed between
<strong>self-employment income and production under the Cannabis
Act</strong>. However, it’s important to note that this relationship may
not be entirely reliable due to the limited data available (3
observations), as illustrated in the plot below.</p>
<p><img src="work_files/figure-html/unnamed-chunk-30-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The second strongest correlation, with a coefficient of 0.98, is
observed between <strong>total income and incidents of possession of
other Controlled Drugs and Substances Act drugs</strong>. With
additional data available, this relationship appears more promising.
Upon examination, it becomes evident that as income levels increase, the
number of incidents of possession of these drugs also tends to rise.
Despite the negative correlation between total income and total crime
rate in Ontario, as found in previous analyses, a positive relationship
exists between total income and incidents of possession of other
Controlled Drugs and Substances Act drugs.</p>
<p><img src="work_files/figure-html/unnamed-chunk-31-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="group-by-income-level" class="section level3">
<h3>Group by Income Level</h3>
<p>I created 4 levels for average total income using the quarantines,
from negative infinity to the first quantile is <strong>“Low”</strong>,
from first quantile to mean is <strong>“Med_Low”</strong>, from mean to
3rd quantile is <strong>“Med_High”</strong>, from 3rd quantile above is
<strong>“High”</strong>.</p>
<pre class="r"><code>filter_census &lt;- census_df %&gt;% filter(`Income source` == &quot;Total income&quot;)
# summary(filter_census$`Average income (excluding zeros)`)
breaks &lt;- c(-Inf, 40460, 45077, 48859, Inf)
filter_census$income_level &lt;- cut(filter_census$`Average income (excluding zeros)`, 
                                  breaks = breaks, labels = c(&quot;Low&quot;, &quot;Med-Low&quot;, &quot;Med-High&quot;, &quot;High&quot;))</code></pre>
<p>From the box plot presented below, it appears that the total crime
rate <strong>does not exhibit a clear trend of decreasing with higher
levels of total income</strong>. This finding contradicts previous
observations when examining the relationship between total crime rate
and average total income <strong>by province</strong>. Therefore, it is
conceivable that while a relationship exists, it may be influenced by
other factors related to the demographics of each province.
Consequently, when considering all observations collectively, the
relationship becomes less apparent.</p>
<p><img src="work_files/figure-html/unnamed-chunk-33-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="fitting-statistical-models" class="section level3">
<h3>Fitting Statistical Models</h3>
<pre class="r"><code>joint_df &lt;- joint_df %&gt;% rename(avg_income = `Average income (excluding zeros)`)</code></pre>
<pre class="r"><code>joint_df &lt;- joint_df %&gt;% rename(crime_rate = `Rate per 100,000 population`)</code></pre>
<p>Since we’ve previously observed in plots such that the
<strong>slope</strong> of the relationship between average total income
and total crime rate is different across provinces, we need to fit a
model with <strong>interaction terms</strong> such that the slopes can
be different.</p>
<pre class="r"><code>library(broom)
lm_model &lt;- lm(data = joint_df, `crime_rate` ~ `avg_income` * `GEO`)
tidy_coeffs &lt;- tidy(lm_model)
table &lt;- tidy_coeffs %&gt;%
  kable(&quot;html&quot;) %&gt;%
  kable_styling(bootstrap_options = &quot;striped&quot;, full_width = TRUE)
table</code></pre>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
14793.6650192
</td>
<td style="text-align:right;">
1437.5519874
</td>
<td style="text-align:right;">
10.2908731
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income
</td>
<td style="text-align:right;">
-0.0965352
</td>
<td style="text-align:right;">
0.0258743
</td>
<td style="text-align:right;">
-3.7309253
</td>
<td style="text-align:right;">
0.0002428
</td>
</tr>
<tr>
<td style="text-align:left;">
GEOBritish Columbia
</td>
<td style="text-align:right;">
13870.9677393
</td>
<td style="text-align:right;">
2312.3835770
</td>
<td style="text-align:right;">
5.9985583
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
GEOManitoba
</td>
<td style="text-align:right;">
7946.1906789
</td>
<td style="text-align:right;">
2296.0365821
</td>
<td style="text-align:right;">
3.4608293
</td>
<td style="text-align:right;">
0.0006468
</td>
</tr>
<tr>
<td style="text-align:left;">
GEONew Brunswick
</td>
<td style="text-align:right;">
-2943.0958277
</td>
<td style="text-align:right;">
2103.8238576
</td>
<td style="text-align:right;">
-1.3989269
</td>
<td style="text-align:right;">
0.1632431
</td>
</tr>
<tr>
<td style="text-align:left;">
GEONewfoundland and Labrador
</td>
<td style="text-align:right;">
-8091.9410527
</td>
<td style="text-align:right;">
1705.7594792
</td>
<td style="text-align:right;">
-4.7438934
</td>
<td style="text-align:right;">
0.0000038
</td>
</tr>
<tr>
<td style="text-align:left;">
GEONova Scotia
</td>
<td style="text-align:right;">
5230.7520879
</td>
<td style="text-align:right;">
2193.8216748
</td>
<td style="text-align:right;">
2.3843105
</td>
<td style="text-align:right;">
0.0179604
</td>
</tr>
<tr>
<td style="text-align:left;">
GEOOntario
</td>
<td style="text-align:right;">
6850.6041303
</td>
<td style="text-align:right;">
3311.9257794
</td>
<td style="text-align:right;">
2.0684655
</td>
<td style="text-align:right;">
0.0397653
</td>
</tr>
<tr>
<td style="text-align:left;">
GEOPrince Edward Island
</td>
<td style="text-align:right;">
1789.8353436
</td>
<td style="text-align:right;">
2029.0026916
</td>
<td style="text-align:right;">
0.8821257
</td>
<td style="text-align:right;">
0.3786716
</td>
</tr>
<tr>
<td style="text-align:left;">
GEOQuebec
</td>
<td style="text-align:right;">
1869.9125139
</td>
<td style="text-align:right;">
2382.7985390
</td>
<td style="text-align:right;">
0.7847548
</td>
<td style="text-align:right;">
0.4334416
</td>
</tr>
<tr>
<td style="text-align:left;">
GEOSaskatchewan
</td>
<td style="text-align:right;">
7458.4753196
</td>
<td style="text-align:right;">
1887.5177478
</td>
<td style="text-align:right;">
3.9514729
</td>
<td style="text-align:right;">
0.0001047
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEOBritish Columbia
</td>
<td style="text-align:right;">
-0.2946092
</td>
<td style="text-align:right;">
0.0467722
</td>
<td style="text-align:right;">
-6.2988076
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEOManitoba
</td>
<td style="text-align:right;">
-0.1693983
</td>
<td style="text-align:right;">
0.0477122
</td>
<td style="text-align:right;">
-3.5504187
</td>
<td style="text-align:right;">
0.0004703
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEONew Brunswick
</td>
<td style="text-align:right;">
-0.0316576
</td>
<td style="text-align:right;">
0.0458147
</td>
<td style="text-align:right;">
-0.6909929
</td>
<td style="text-align:right;">
0.4902984
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEONewfoundland and Labrador
</td>
<td style="text-align:right;">
0.0963984
</td>
<td style="text-align:right;">
0.0338286
</td>
<td style="text-align:right;">
2.8496116
</td>
<td style="text-align:right;">
0.0047929
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEONova Scotia
</td>
<td style="text-align:right;">
-0.2025528
</td>
<td style="text-align:right;">
0.0469679
</td>
<td style="text-align:right;">
-4.3125776
</td>
<td style="text-align:right;">
0.0000244
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEOOntario
</td>
<td style="text-align:right;">
-0.2319253
</td>
<td style="text-align:right;">
0.0654035
</td>
<td style="text-align:right;">
-3.5460653
</td>
<td style="text-align:right;">
0.0004777
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEOPrince Edward Island
</td>
<td style="text-align:right;">
-0.1471245
</td>
<td style="text-align:right;">
0.0441284
</td>
<td style="text-align:right;">
-3.3340081
</td>
<td style="text-align:right;">
0.0010044
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEOQuebec
</td>
<td style="text-align:right;">
-0.1635189
</td>
<td style="text-align:right;">
0.0506113
</td>
<td style="text-align:right;">
-3.2308755
</td>
<td style="text-align:right;">
0.0014233
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_income:GEOSaskatchewan
</td>
<td style="text-align:right;">
-0.0726509
</td>
<td style="text-align:right;">
0.0362467
</td>
<td style="text-align:right;">
-2.0043456
</td>
<td style="text-align:right;">
0.0462590
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(lm_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = crime_rate ~ avg_income * GEO, data = joint_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1794.76  -513.35    32.88   557.20  1861.64 
## 
## Coefficients:
##                                           Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                              1.479e+04  1.438e+03  10.291  &lt; 2e-16
## avg_income                              -9.654e-02  2.587e-02  -3.731 0.000243
## GEOBritish Columbia                      1.387e+04  2.312e+03   5.999 8.10e-09
## GEOManitoba                              7.946e+03  2.296e+03   3.461 0.000647
## GEONew Brunswick                        -2.943e+03  2.104e+03  -1.399 0.163243
## GEONewfoundland and Labrador            -8.092e+03  1.706e+03  -4.744 3.77e-06
## GEONova Scotia                           5.231e+03  2.194e+03   2.384 0.017960
## GEOOntario                               6.851e+03  3.312e+03   2.068 0.039765
## GEOPrince Edward Island                  1.790e+03  2.029e+03   0.882 0.378672
## GEOQuebec                                1.870e+03  2.383e+03   0.785 0.433442
## GEOSaskatchewan                          7.458e+03  1.888e+03   3.951 0.000105
## avg_income:GEOBritish Columbia          -2.946e-01  4.677e-02  -6.299 1.61e-09
## avg_income:GEOManitoba                  -1.694e-01  4.771e-02  -3.550 0.000470
## avg_income:GEONew Brunswick             -3.166e-02  4.581e-02  -0.691 0.490298
## avg_income:GEONewfoundland and Labrador  9.640e-02  3.383e-02   2.850 0.004793
## avg_income:GEONova Scotia               -2.026e-01  4.697e-02  -4.313 2.44e-05
## avg_income:GEOOntario                   -2.319e-01  6.540e-02  -3.546 0.000478
## avg_income:GEOPrince Edward Island      -1.471e-01  4.413e-02  -3.334 0.001004
## avg_income:GEOQuebec                    -1.635e-01  5.061e-02  -3.231 0.001423
## avg_income:GEOSaskatchewan              -7.265e-02  3.625e-02  -2.004 0.046259
##                                            
## (Intercept)                             ***
## avg_income                              ***
## GEOBritish Columbia                     ***
## GEOManitoba                             ***
## GEONew Brunswick                           
## GEONewfoundland and Labrador            ***
## GEONova Scotia                          *  
## GEOOntario                              *  
## GEOPrince Edward Island                    
## GEOQuebec                                  
## GEOSaskatchewan                         ***
## avg_income:GEOBritish Columbia          ***
## avg_income:GEOManitoba                  ***
## avg_income:GEONew Brunswick                
## avg_income:GEONewfoundland and Labrador ** 
## avg_income:GEONova Scotia               ***
## avg_income:GEOOntario                   ***
## avg_income:GEOPrince Edward Island      ** 
## avg_income:GEOQuebec                    ** 
## avg_income:GEOSaskatchewan              *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 770.8 on 220 degrees of freedom
## Multiple R-squared:  0.9381, Adjusted R-squared:  0.9328 
## F-statistic: 175.6 on 19 and 220 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The linear regression model examines the relationship between
<strong>Crime Rate per 100,000 population</strong> and <strong>Average
income (excluding zeros)</strong> while considering the categorical
variable <code>GEO</code> representing different
<strong>provinces</strong>. The model reveals several significant
findings: firstly, a <strong>negative relationship</strong> exists
between average total income and total crime rate, suggesting that
higher average income tends to be associated with lower crime rates.
Secondly, various provinces exhibit differing baseline rates, with
<strong>British Columbia</strong> notably displaying a significantly
higher rate compared to the reference province. Additionally,
interaction terms between income and provinces indicate varying effects
across regions, such as a stronger negative association between income
and crime rate in British Columbia. Overall, the model, with an adjusted
<strong>R-squared value of 0.9328</strong>, indicates a robust fit,
suggesting that both income and province significantly influence the
rate per 100,000 population, with nuanced variations across different
regions.</p>
<pre class="r"><code>set.seed(123)
rf_model &lt;- randomForest(crime_rate ~ GEO + avg_income,
                         data = joint_df,
                         na.action = na.omit)

varImpPlot(rf_model, main = &quot;Variale Importance Plot for Random Forest&quot;)</code></pre>
<p><img src="work_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>rf_model</code></pre>
<pre><code>## 
## Call:
##  randomForest(formula = crime_rate ~ GEO + avg_income, data = joint_df,      na.action = na.omit) 
##                Type of random forest: regression
##                      Number of trees: 500
## No. of variables tried at each split: 1
## 
##           Mean of squared residuals: 618320.4
##                     % Var explained: 92.98</code></pre>
<p>The model explains approximately 90.24% of the variance in the crime
rate, which suggests that the predictor variables (REF_DATE, GEO, and
avg_income) collectively have a strong relationship with the crime rate.
The mean of squared residuals is relatively high (859479.8), indicating
that there is still some unexplained variability in the data that the
model is not capturing well. This suggests that there may be other
factors influencing the crime rate that are not included in the model.
Considering only one variable at each split might simplify the model and
make it easier to interpret, but it might not capture complex
interactions between variables.</p>
<pre class="r"><code>gam_model &lt;- gam(crime_rate ~ s(REF_DATE) + GEO + avg_income, data = joint_df)

summary(gam_model)</code></pre>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## crime_rate ~ s(REF_DATE) + GEO + avg_income
## 
## Parametric coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   3.850e+03  1.210e+03   3.183 0.001666 ** 
## GEOBritish Columbia           1.994e+03  2.704e+02   7.375 3.28e-12 ***
## GEOManitoba                   2.538e+03  3.002e+02   8.454 3.83e-15 ***
## GEONew Brunswick             -1.287e+03  3.734e+02  -3.448 0.000676 ***
## GEONewfoundland and Labrador -1.373e+03  3.530e+02  -3.889 0.000133 ***
## GEONova Scotia               -6.904e+02  3.425e+02  -2.016 0.045021 *  
## GEOOntario                   -3.539e+03  2.246e+02 -15.757  &lt; 2e-16 ***
## GEOPrince Edward Island      -1.014e+03  3.847e+02  -2.635 0.009007 ** 
## GEOQuebec                    -2.933e+03  3.165e+02  -9.267  &lt; 2e-16 ***
## GEOSaskatchewan               5.461e+03  2.484e+02  21.985  &lt; 2e-16 ***
## avg_income                    1.016e-01  2.177e-02   4.668 5.27e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F p-value    
## s(REF_DATE) 8.121  8.792 30.53  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.952   Deviance explained = 95.5%
## GCV = 4.6253e+05  Scale est. = 4.2568e+05  n = 240</code></pre>
<pre class="r"><code>set.seed(123)
train_control = caret::trainControl(method = &quot;cv&quot;, number = 10, search =&quot;grid&quot;)

tune_grid&lt;-  expand.grid(max_depth = 3, #larger makes model more complex and potentially overfit
                        nrounds = 300, # number of trees
                        # default values below
                        eta = 0.1, # learning rate (equivalent to shrinkage)
                        gamma = 0, #Minimum loss reduction required to make a further partition on a leaf node of the tree. The larger gamma is, the more conservative the algorithm will be.
                        subsample = 1,
                        min_child_weight = 1,
                        colsample_bytree = 0.6 #specify the fraction of columns to be subsampled
                        )

xgb_model&lt;-caret::train(
  crime_rate ~ REF_DATE + GEO + avg_income,
  data = joint_df,
  method = &#39;xgbTree&#39;,
  trControl = train_control,
  tuneGrid = tune_grid,
  na.action = na.omit,
  verbosity=0
)</code></pre>
<pre class="r"><code>print(xgb_model)</code></pre>
<pre><code>## eXtreme Gradient Boosting 
## 
## 240 samples
##   3 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 216, 216, 216, 216, 216, 216, ... 
## Resampling results:
## 
##   RMSE     Rsquared   MAE     
##   469.094  0.9773425  371.3526
## 
## Tuning parameter &#39;nrounds&#39; was held constant at a value of 300
## Tuning
##  held constant at a value of 1
## Tuning parameter &#39;subsample&#39; was held
##  constant at a value of 1</code></pre>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p><em>“What you found so far from your data in terms of the formulated
question.”</em></p>
<p>Recall that the question of interest is: <strong>“How does crime rate
relate to income in Canada?”</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Looking at Crime Data:</strong></li>
</ol>
<ul>
<li>Saskatchewan consistently exhibits a significantly higher total
crime rate compared to other provinces throughout the period of 1998 to
2021.</li>
<li>Quebec and Ontario consistently demonstrate the lowest total crime
rates.</li>
<li>Across all provinces, there is a discernible decreasing trend in
total crime rates over the years.</li>
<li>Many provinces experiencing peak total crime rates in
2003-2004.</li>
<li>There is a decreasing trend in the rates of break and enter,
robbery, and prostitution in all provinces.</li>
<li>British Columbia stands out with a significantly high rate of
prostitution in 2004, doubling the number reported in Saskatchewan,
which held the second-highest rate that year.</li>
<li>Across all provinces, there is a discernible decreasing trend in the
average crime rate of all types, from year to year.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Looking at Income Data:</strong></li>
</ol>
<ul>
<li>On the whole, the average total income for all provinces exhibits a
steady upward trend.</li>
<li>Since 2003, Alberta has surpassed Ontario to become the province
with the highest average total income.</li>
<li>There is a slight decrease in average total income across all
provinces around 2019, likely attributed to the impact of the COVID-19
pandemic.</li>
<li>Employment income, investment income, and market income of provinces
are all increasing.</li>
<li>Employment and market income show a more steady growth pattern,
while investment income fluctuates dramatically from year to year.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Examining Crime and Income Together:</strong></li>
</ol>
<ul>
<li>Average total income and total crime rate are negatively correlated
across all provinces.</li>
<li>Quebec exhibits the strongest correlation between average total
income and total crime rate as the correlation is close to -1.</li>
<li>In the relationship between robbery crime rate and employment
income, all provinces display a negative trend except for Newfoundland
and Labrador. Manitoba demonstrates a weak relationship, as evidenced by
the considerable dispersion of points around the line.</li>
<li>Property crime rate decreases with increasing market income in all
provinces.</li>
<li>Employment income and prostitution crime rate have varying degrees
of association across provinces, with many showing a weak relationship.
Notably, Ontario exhibits a positive relationship between employment
income and prostitution crime rate while it is negative for other
provinces.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Zoom on Province - Ontario:</strong></li>
</ol>
<ul>
<li>Major crimes in Ontario are property crime and weapon
violations.</li>
<li>Strongest correlation is observed between self-employment income and
production under the Cannabis Act. However, it’s important to note that
this relationship may not be entirely reliable due to the limited data
available.</li>
<li>The second strongest correlation, with a coefficient of 0.98, is
observed between total income and incidents of possession of other
Controlled Drugs and Substances Act drugs. As income levels increase,
the number of incidents of possession of these drugs also tends to
rise.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Group by Income Level:</strong></li>
</ol>
<ul>
<li>Created 4 levels for average total income using the quarantines,
from negative infinity to the first quantile is “Low”, from first
quantile to mean is “Med_Low”, from mean to 3rd quantile is “Med_High”,
from 3rd quantile above is “High”.</li>
<li>Total crime rate does not exhibit a clear trend of decreasing with
higher levels of total income, which contradicts previous observations
when examining the relationship between total crime rate and average
total income by province. while a relationship exists, it may be
influenced by other factors related to the demographics of each
province. Consequently, when considering all observations collectively,
the relationship becomes less apparent.</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><strong>Fitting Statistical Models:</strong></li>
</ol>
<ul>
<li>The linear regression model analyzed the relationship between Crime
Rate per 100,000 population and Average income (excluding zeros) across
different provinces represented by the categorical variable GEO.</li>
<li>Findings suggest a negative correlation between average income and
total crime rate, implying that higher average income tends to coincide
with lower crime rates.</li>
<li>Provinces exhibit varying baseline rates, with British Columbia
notably showing a significantly higher rate compared to the reference
province.</li>
<li>Interaction terms between income and provinces reveal differing
effects across regions, such as a more pronounced negative association
between income and crime rate in British Columbia.</li>
<li>The model demonstrates a robust fit with an adjusted R-squared value
of 0.9328, indicating significant influences of both income and province
on the crime rate per 100,000 population, with nuanced variations across
different regions.</li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
